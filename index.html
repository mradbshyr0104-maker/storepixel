<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุชุฌุฑ ุจูุณู</title>
    <link rel="icon" href="https://i.postimg.cc/cH21G5hv/017ce4679e425014.gif" type="image/gif">
    <!-- ุชุถููู Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ููุชุจุฉ YouTube Background Video -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery.mb.ytplayer@3.3.9/dist/jquery.mb.YTPlayer.min.js"></script>
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="supabase-api.js"></script>

    <!-- ุฎุท Cairo ูุฏุนู ุงูุนุฑุจูุฉ ูุน ูุธูุฑ ููู -->
    <style type="text/tailwindcss">
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;700;900&display=swap');
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #0A0A0A; /* ุฎูููุฉ ุณูุฏุงุก ุนูููุฉ */
            color: #E5E7EB; /* ููู ุงููุต ุงููุงุชุญ */
        }
        /* ุชุตููู ุฒุฑ ุฑุฆูุณู ูุฎุตุต */
        @layer components {
            .btn-primary {
                @apply bg-cyan-500 hover:bg-cyan-400 text-gray-900 font-bold py-3 px-8 rounded-full transition duration-300 transform hover:scale-105 shadow-xl shadow-cyan-500/50;
            }
            .btn-secondary {
                @apply bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-full transition duration-300 transform hover:scale-105 shadow-xl shadow-gray-500/30;
            }
            .btn-discord {
                @apply bg-[#5865F2] hover:bg-[#4f5bda] text-white font-bold py-5 px-16 rounded-md text-3xl transition duration-300 transform hover:scale-105 shadow-xl shadow-indigo-500/50;
            }
            /* ุชุตููู ุจุทุงูุฉ ูููุฒุฉ ูุตูุญุฉ ุงูุฑุฆูุณูุฉ */
            .feature-card {
                @apply bg-gray-900/70 rounded-xl shadow-2xl border border-gray-800 hover:border-cyan-500 transition duration-300 transform hover:scale-[1.03] hover:shadow-cyan-500/50 overflow-hidden flex flex-col;
            }
            .card-image-container {
                height: 320px; 
                @apply w-full overflow-hidden;
            }
            .card-image {
                @apply w-full h-full object-cover transition duration-500 group-hover:scale-110;
            }
            /* ุชุตููู ุจุทุงูุฉ ุงูููุชุฌ ูุตูุญุงุช ุงูููุงุชุฑ */
            .product-card {
                @apply bg-gray-900 rounded-lg shadow-xl border border-gray-800 hover:border-cyan-500 transition duration-300 overflow-hidden;
            }
            .image-carousel {
                position: relative;
                overflow: hidden;
            }
            .carousel-nav {
                position: absolute;
                top: 50%;
                transform: translateY(-50%);
                background: rgba(0, 0, 0, 0.7);
                color: white;
                border: none;
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: all 0.3s;
                z-index: 10;
            }
            .carousel-nav:hover {
                background: rgba(6, 182, 212, 0.8);
                transform: translateY(-50%) scale(1.1);
            }
            .carousel-prev {
                left: 8px;
            }
            .carousel-next {
                right: 8px;
            }
            .image-indicators {
                position: absolute;
                bottom: 8px;
                left: 50%;
                transform: translateX(-50%);
                display: flex;
                gap: 4px;
                z-index: 10;
            }
            .indicator {
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background: rgba(255, 255, 255, 0.5);
                cursor: pointer;
                transition: all 0.3s;
            }
            .indicator.active {
                background: #06b6d4;
                transform: scale(1.2);
            }
        }
    </style>


</head>
<body class="antialiased">

    <!-- ุดุงุดุฉ ุงูุชุฑุญูุจ ุงูุงุญุชุฑุงููุฉ -->
    <div id="welcomeScreen" class="fixed inset-0 z-[9999] overflow-hidden">
        <!-- ุฎูููุฉ ูุชุญุฑูุฉ ูุน ุฌุฒูุฆุงุช -->
        <div class="absolute inset-0 bg-black">
            <div class="particles-container absolute inset-0"></div>
            <div class="absolute inset-0 bg-gradient-to-br from-cyan-900/30 via-black to-blue-900/30"></div>
            
            <!-- ุฏูุงุฆุฑ ูุชููุฌุฉ ูุชุญุฑูุฉ -->
            <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-cyan-500/20 rounded-full blur-3xl animate-float"></div>
            <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-blue-500/20 rounded-full blur-3xl animate-float-delayed"></div>
            <div class="absolute top-1/2 left-1/2 w-64 h-64 bg-purple-500/10 rounded-full blur-3xl animate-pulse"></div>
        </div>
        
        <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
        <div class="relative z-10 h-full flex items-center justify-center">
            <div class="text-center px-4">
                <!-- ุงูุดุนุงุฑ ูุน ุชุฃุซูุฑุงุช ูููุฉ -->
                <div class="mb-12 animate-scaleIn">
                    <div class="relative inline-block">
                        <div class="absolute inset-0 animate-ping-slow opacity-75">
                            <img src="https://i.postimg.cc/cH21G5hv/017ce4679e425014.gif" 
                                 alt="ุดุนุงุฑ" 
                                 class="h-48 w-48 mx-auto object-contain opacity-30">
                        </div>
                        <img src="https://i.postimg.cc/cH21G5hv/017ce4679e425014.gif" 
                             alt="ุดุนุงุฑ ุจูุณู" 
                             class="h-48 w-48 mx-auto object-contain relative z-10 drop-shadow-[0_0_50px_rgba(6,182,212,1)]">
                    </div>
                </div>
                
                <!-- ุงููุต ุงูุนุฑุจู ุจุชุฃุซูุฑ ููู -->
                <h1 class="text-7xl md:text-8xl font-black mb-6 animate-slideUp" 
                    style="text-shadow: 0 0 80px rgba(6,182,212,0.8), 0 0 40px rgba(6,182,212,0.6), 0 0 20px rgba(6,182,212,0.4);">
                    <span class="inline-block bg-gradient-to-r from-cyan-300 via-cyan-500 to-blue-500 bg-clip-text text-transparent animate-shimmer" 
                          style="background-size: 200% auto;">
                        ูุฑุญุจุงู ุจูู ูู ูุชุฌุฑ ุจูุณู
                    </span>
                </h1>
                
                <!-- ุงููุต ุงูุฅูุฌููุฒู -->
                <p class="text-4xl md:text-5xl font-bold text-white/90 mb-12 tracking-[0.3em] animate-slideUp-delayed"
                   style="text-shadow: 0 0 30px rgba(255,255,255,0.5);">
                    WELCOME TO PIXEL STORE
                </p>
                
                <!-- ุฎุทูุท ูุชููุฌุฉ -->
                <div class="flex justify-center items-center gap-4 mb-8 animate-fadeIn-delayed">
                    <div class="w-32 h-0.5 bg-gradient-to-r from-transparent via-cyan-500 to-cyan-500 animate-pulse"></div>
                    <div class="w-4 h-4 bg-cyan-500 rounded-full animate-ping"></div>
                    <div class="w-32 h-0.5 bg-gradient-to-l from-transparent via-cyan-500 to-cyan-500 animate-pulse"></div>
                </div>
                
                <!-- ููุงุท ุงูุชุญููู ุงูุงุญุชุฑุงููุฉ -->
                <div class="flex justify-center items-center gap-3 animate-fadeIn-delayed">
                    <div class="w-4 h-4 rounded-full bg-gradient-to-r from-cyan-400 to-cyan-600 animate-bounce shadow-lg shadow-cyan-500/50" style="animation-delay: 0s;"></div>
                    <div class="w-4 h-4 rounded-full bg-gradient-to-r from-cyan-400 to-cyan-600 animate-bounce shadow-lg shadow-cyan-500/50" style="animation-delay: 0.15s;"></div>
                    <div class="w-4 h-4 rounded-full bg-gradient-to-r from-cyan-400 to-cyan-600 animate-bounce shadow-lg shadow-cyan-500/50" style="animation-delay: 0.3s;"></div>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* ุงูุฌุฒูุฆุงุช ุงููุชุญุฑูุฉ */
        .particles-container {
            background-image: 
                radial-gradient(2px 2px at 20% 30%, rgba(6,182,212,0.3), transparent),
                radial-gradient(2px 2px at 60% 70%, rgba(59,130,246,0.3), transparent),
                radial-gradient(1px 1px at 50% 50%, rgba(6,182,212,0.2), transparent),
                radial-gradient(1px 1px at 80% 10%, rgba(59,130,246,0.2), transparent),
                radial-gradient(2px 2px at 90% 60%, rgba(6,182,212,0.3), transparent),
                radial-gradient(1px 1px at 33% 80%, rgba(59,130,246,0.2), transparent);
            background-size: 200% 200%;
            animation: particles 20s ease-in-out infinite;
        }
        
        @keyframes particles {
            0%, 100% { background-position: 0% 0%, 100% 100%, 50% 50%, 80% 10%, 90% 60%, 33% 80%; }
            50% { background-position: 100% 100%, 0% 0%, 80% 80%, 20% 90%, 10% 40%, 67% 20%; }
        }
        
        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -30px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
        }
        
        @keyframes float-delayed {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(-30px, 30px) scale(0.9); }
            66% { transform: translate(20px, -20px) scale(1.1); }
        }
        
        .animate-float {
            animation: float 8s ease-in-out infinite;
        }
        
        .animate-float-delayed {
            animation: float-delayed 10s ease-in-out infinite;
        }
        
        @keyframes scaleIn {
            0% {
                opacity: 0;
                transform: scale(0.5) rotate(-10deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }
        
        .animate-scaleIn {
            animation: scaleIn 1s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        @keyframes slideUp {
            0% {
                opacity: 0;
                transform: translateY(50px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-slideUp {
            animation: slideUp 0.8s ease-out 0.3s both;
        }
        
        .animate-slideUp-delayed {
            animation: slideUp 0.8s ease-out 0.6s both;
        }
        
        .animate-fadeIn-delayed {
            animation: fadeIn 0.8s ease-out 0.9s both;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }
        
        .animate-shimmer {
            animation: shimmer 3s linear infinite;
        }
        
        @keyframes ping-slow {
            75%, 100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }
        
        .animate-ping-slow {
            animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        
        #welcomeScreen {
            animation: fadeOutScreen 1s ease-out 4s forwards;
        }
        
        @keyframes fadeOutScreen {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }
    </style>

    <script>
        setTimeout(function() {
            document.getElementById('welcomeScreen').style.display = 'none';
        }, 5000);
    </script>

    <!-- ุดุฑูุท ุงูุชููู (Header) - ุดุฑูุท ุฏุงูู ุดุจู ุดูุงู -->
    <header class="bg-black/80 backdrop-blur-sm shadow-2xl shadow-black/50 sticky top-0 z-50 border-b border-cyan-500/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-24">
                <!-- ุงูุดุนุงุฑ -->
                <div class="flex-shrink-0">
                    <a href="#" onclick="handleLogoClick(event)" class="flex items-center">
                        <img src="https://i.postimg.cc/cH21G5hv/017ce4679e425014.gif" alt="ุดุนุงุฑ ููุงุทุนุฉ ุจูุณู" class="h-16 w-auto object-contain">
                    </a>
                </div>
                
                <!-- ุฑูุงุจุท ุงูุชููู (ุชู ุฑุจุทูุง ุจูุธููุฉ navigateTo) -->
                <nav class="hidden md:flex items-center gap-6">
                    <a href="#" data-page="home" class="nav-link text-gray-200 hover:text-cyan-400 transition duration-150 font-semibold text-base whitespace-nowrap">ุงูุฑุฆูุณูุฉ</a>
                    <a href="#" data-page="investment" class="nav-link text-gray-200 hover:text-cyan-400 transition duration-150 font-semibold text-base whitespace-nowrap">ูุฑุต ุงูุงุณุชุซูุงุฑ</a>
                    <a href="#" data-page="vehicles" class="nav-link text-gray-200 hover:text-cyan-400 transition duration-150 font-semibold text-base whitespace-nowrap">ูุฑูุจุงุช ุจูุณู</a>
                    <a href="#" data-page="sponsors" class="nav-link text-gray-200 hover:text-cyan-400 transition duration-150 font-semibold text-base whitespace-nowrap">ุฑูุงุนู ุจูุณู</a>
                    <a href="#" data-page="money-services" class="nav-link text-gray-200 hover:text-cyan-400 transition duration-150 font-semibold text-base whitespace-nowrap">ุฎุฏูุงุช ุงูุฃููุงู</a>
                    <a href="#" data-page="ban-jail" class="nav-link text-gray-200 hover:text-cyan-400 transition duration-150 font-semibold text-base whitespace-nowrap">ุงูุจุงูุฏ ูุงูุณุฌู</a>
                </nav>

                <!-- ุงูุฃุฒุฑุงุฑ ูุงูุนููุฉ -->
                <div class="flex items-center gap-3">
                    <!-- ุฒุฑ ุชุบููุฑ ุงูุนููุฉ -->
                    <button id="currency-toggle-button" class="flex items-center gap-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 px-5 py-2.5 rounded-full text-base font-bold transition transform hover:scale-105 focus:outline-none shadow-lg">
                        <!-- ุณูุชู ููุก ูุฐุง ุจูุงุณุทุฉ JavaScript -->
                    </button>
                    <button id="cart-button" class="relative text-cyan-500 hover:text-cyan-400 p-3 bg-gray-800 rounded-full transition duration-150 focus:outline-none shadow-md hover:shadow-cyan-500/30">
                        <!-- ุฃููููุฉ ุณูุฉ ุงูุชุณูู (SVG) -->
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                        <span id="cart-counter" class="absolute -top-1 -right-1 bg-red-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                    </button>
                    <!-- ูุงุฆูุฉ ุงูููุจุงูู (Hamburger Menu) -->
                    <button id="mobile-menu-button" class="md:hidden text-cyan-500 hover:text-cyan-400 p-2 rounded-lg focus:outline-none">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- ูุงุฆูุฉ ุงูููุจุงูู ุงูููุจุซูุฉ (ุชู ุฑุจุทูุง ุจูุธููุฉ navigateTo) -->
        <div id="mobile-menu" class="hidden md:hidden bg-black border-t border-gray-700">
            <a href="#" data-page="home" class="nav-link block px-4 py-3 text-white hover:bg-gray-800 transition duration-150">ุงูุฑุฆูุณูุฉ</a>
            <a href="#" data-page="investment" class="nav-link block px-4 py-3 text-white hover:bg-gray-800 transition duration-150">ูุฑุต ุงูุงุณุชุซูุงุฑ</a>
            <a href="#" data-page="vehicles" class="nav-link block px-4 py-3 text-white hover:bg-gray-800 transition duration-150">ูุฑูุจุงุช ุจูุณู</a>
            <a href="#" data-page="sponsors" class="nav-link block px-4 py-3 text-white hover:bg-gray-800 transition duration-150">ุฑูุงุนู ุจูุณู</a>
            <a href="#" data-page="money-services" class="nav-link block px-4 py-3 text-white hover:bg-gray-800 transition duration-150">ุฎุฏูุงุช ุงูุฃููุงู</a>
            <a href="#" data-page="ban-jail" class="nav-link block px-4 py-3 text-white hover:bg-gray-800 transition duration-150">ุงูุจุงูุฏ ูุงูุณุฌู</a>
        </div>
    </header>

    <!-- ุดุฑูุท ุฅุดุนุงุฑ ุงูุนุฑุถ (ูุธูุฑ ุนูุฏ ูุฌูุฏ ุนุฑุถ) -->
    <div id="sale-banner" class="hidden text-center py-2 px-4 font-bold shadow-lg">
        <!-- ุณูุชู ููุก ูุฐุง ุจูุงุณุทุฉ JavaScript -->
    </div>


    <!-- ูุญุชูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ (Main Content) - ุณูุชู ุงุณุชุจุฏุงูู ุฏููุงููููุงู -->
    <main id="main-content" class="min-h-screen">
        <!-- ูุชู ุชุญููู ูุญุชูู ุงูุตูุญุฉ ููุง ุจูุงุณุทุฉ JavaScript -->
    </main>

    <!-- ูุงูุฐุฉ ุณูุฉ ุงูุชุณูู ุงูููุจุซูุฉ (Cart Modal) -->
    <div id="cart-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center">
        <!-- ูุญุชูู ุงููุงูุฐุฉ -->
        <div class="bg-gray-900 w-full max-w-2xl rounded-xl shadow-2xl border border-cyan-500/50 flex flex-col max-h-[90vh]">
            <!-- ุฑุฃุณ ุงููุงูุฐุฉ -->
            <div class="flex justify-between items-center p-5 border-b border-gray-800">
                <h3 class="text-2xl font-bold text-white">ุณูุฉ ุงูุชุณูู</h3>
                <button id="close-cart-button" class="text-gray-500 hover:text-white transition duration-150">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>

            <!-- ูุญุชููุงุช ุงูุณูุฉ -->
            <div id="cart-items-container" class="p-6 overflow-y-auto flex-grow">
                <!-- ุณูุชู ููุก ูุฐุง ุจูุงุณุทุฉ JavaScript -->
                <!-- ูุซุงู ุนูู ุนูุตุฑ ูุงุฑุบ -->
                <!-- <p class="text-gray-400 text-center py-10">ุณูุฉ ุงูุชุณูู ูุงุฑุบุฉ ุญุงููุงู.</p> -->
            </div>

            <!-- ุชุฐููู ุงููุงูุฐุฉ -->
            <div class="p-5 border-t border-gray-800 bg-black/30 rounded-b-xl">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-lg text-gray-300">ุงูุฅุฌูุงูู:</span>
                    <span id="cart-total" class="text-3xl font-extrabold text-cyan-400">0$</span>
                </div>
                <button onclick="showCheckoutStep()" class="w-full btn-primary">ุฅุชูุงู ุนูููุฉ ุงูุดุฑุงุก</button>
            </div>
        </div>

        <!-- ูุงูุฐุฉ ุฅุชูุงู ุงูุทูุจ (Checkout) -->
        <div id="checkout-step" class="bg-gray-900 w-full max-w-2xl rounded-xl shadow-2xl border border-cyan-500/50 flex-col max-h-[90vh] hidden">
             <div class="flex justify-between items-center p-5 border-b border-gray-800">
                <h3 class="text-2xl font-bold text-white">ุฅุชูุงู ุงูุทูุจ</h3>
                <button onclick="showCartStep()" class="text-gray-500 hover:text-white transition duration-150 flex items-center gap-2">&larr; ุงูุนูุฏุฉ ููุณูุฉ</button>
            </div>
            <div class="p-6 space-y-6 overflow-y-auto">
                <!-- ูุณู ููุฎุต ุงูุทูุจ ุงูุฌุฏูุฏ -->
                <div class="bg-gray-800 p-4 rounded-lg space-y-2">
                    <h4 class="text-lg font-semibold text-white mb-3 border-b border-gray-700 pb-2">ููุฎุต ุงูุทูุจ</h4>
                    <div id="checkout-summary-container" class="text-sm space-y-2">
                        <!-- ุณูุชู ููุก ูุฐุง ุจูุงุณุทุฉ JavaScript -->
                    </div>
                </div>
                <div>
                    <label for="ingame-name" class="block text-lg font-medium text-cyan-400 mb-2">ุงุณูู ุฏุงุฎู ุงููุนุจุฉ (ููู ููุชุณููู)</label>
                    <input type="text" id="ingame-name" placeholder="ุงูุชุจ ุงุณูู ููุง..." required class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-3 focus:ring-cyan-500 focus:border-cyan-500">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="customer-email" class="block text-lg font-medium text-cyan-400 mb-2">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                        <input type="email" id="customer-email" placeholder="example@email.com" required class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-3 focus:ring-cyan-500 focus:border-cyan-500">
                    </div>
                    <div>
                        <label for="customer-phone" class="block text-lg font-medium text-cyan-400 mb-2">ุฑูู ุงููุงุชู</label>
                        <input type="tel" id="customer-phone" placeholder="05xxxxxxxx" required class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-3 focus:ring-cyan-500 focus:border-cyan-500">
                    </div>
                </div>
                 <div class="bg-gray-800 p-4 rounded-lg space-y-3">
                    <h4 class="text-lg font-semibold text-white">ูุฏูู ููุฏ ุฎุตูุ</h4>
                    <div class="flex gap-2">
                        <input type="text" id="discount-code-input" placeholder="ุฃุฏุฎู ุงูููุฏ ููุง" class="flex-grow bg-gray-700 text-white border border-gray-600 rounded-lg p-2 focus:ring-yellow-500 focus:border-yellow-500">
                        <button onclick="applyDiscountCode()" class="bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-2 px-5 rounded-lg transition">ุชุทุจูู</button>
                    </div>
                    <p id="discount-message" class="text-sm text-center"></p>
                </div>
                <div>
                    <label for="transaction-id" class="block text-lg font-medium text-cyan-400 mb-2">ุฑูู ุนูููุฉ ุงูุชุญููู (ุฅูุฒุงูู)</label>
                    <input type="text" id="transaction-id" placeholder="ุฃุฏุฎู ุฑูู ุงูุนูููุฉ ูู PayPal ุฃู ุฅูุตุงู ุงูุจูู" required class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-3 focus:ring-cyan-500 focus:border-cyan-500">
                    <p class="text-xs text-gray-500 mt-1">ูุฐุง ุงูุฑูู ุถุฑูุฑู ูุชุฃููุฏ ุฏูุนู ูุชุฌูุจ ุฃู ุชุฃุฎูุฑ.</p>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg mt-4">
                    <h4 class="text-lg font-semibold text-white mb-3">ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน:</h4>
                    <p class="text-sm text-gray-400 mb-4">ุจุนุฏ ุงูุฏูุนุ ุงุถุบุท ุนูู ุฒุฑ "ุชุฃููุฏ ุงูุทูุจ" ุฃุฏูุงู ููุชู ุฅุนูุงู ุงูุฅุฏุงุฑุฉ.</p>
                    <div class="flex gap-4">
                        <a href="https://www.paypal.com/paypalme/wek0" target="_blank" class="flex-1 text-center bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg transition">ุงุฏูุน ุนุจุฑ PayPal</a>
                        <button onclick="showBankTransferModal()" class="flex-1 bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded-lg transition">ุนุฑุถ ุจูุงูุงุช ุงูุชุญููู ุงูุจููู</button>
                    </div>
                </div>
            </div>
             <div class="p-5 mt-auto border-t border-gray-800 bg-black/30 rounded-b-xl">
                <div class="bg-red-900/50 border border-red-500 text-red-300 px-4 py-3 rounded-lg relative mb-4 text-center" role="alert">
                    <strong class="font-bold">ุชูุจูู ูุงู: </strong>
                    <span class="block sm:inline">ุจุนุฏ ุฅุชูุงู ุงูุทูุจุ ุณูุธูุฑ ูู <strong>ููุฏ ุชุญูู</strong>. ูุฑุฌู ุญูุธู ูุชูุฏููู ููุฏุนู ุงูููู ูุชุณููู ุงูููุชุฌ.</span>
                </div>
                <button onclick="confirmOrder()" class="w-full bg-cyan-500 hover:bg-cyan-400 text-gray-900 font-bold py-3 rounded-lg transition text-lg">ููุฏ ููุช ุจุงูุฏูุนุ ูู ุจุชุฃููุฏ ุทูุจู</button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุฅูุตุงู ุงูุทูุจ (Receipt Modal) -->
    <div id="receipt-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="relative bg-white text-black w-full max-w-md rounded-lg shadow-2xl max-h-[90vh] flex flex-col">
            <button onclick="closeReceipt()" class="absolute top-3 right-3 text-gray-400 hover:text-black transition-transform duration-200 hover:scale-125 z-10">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <div id="receipt-content" class="p-6 overflow-y-auto flex-grow">
                <h2 class="text-2xl font-bold text-center border-b pb-4 mb-4 sticky top-0 bg-white z-10">ุชู ุชุฃููุฏ ุทูุจู ุจูุฌุงุญ</h2>
                <div class="text-center bg-cyan-100 border-2 border-dashed border-cyan-500 p-4 rounded-lg">
                    <p class="text-lg font-bold text-gray-800">ูุฐุง ูู ููุฏ ุงูุชุญูู ุงูุฎุงุต ุจุทูุจู:</p>
                    <div class="flex justify-center items-center gap-2 my-3">
                        <p id="receipt-verification-code" class="text-4xl font-extrabold text-cyan-700 font-mono tracking-widest"></p>
                        <button onclick="copyToClipboard(this, 'receipt-verification-code', 'ุชู ูุณุฎ ุงูููุฏ!')" class="relative bg-cyan-600 hover:bg-cyan-500 text-white p-2 rounded-lg transition" title="ูุณุฎ ุงูููุฏ">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                        </button>
                    </div>
                    <p class="text-sm text-gray-600">ูุฑุฌู ุงูุงุญุชูุงุธ ุจูุฐุง ุงูููุฏ ูุชูุฏููู ููุฏุนู ุงูููู ูุชุณููู ุทูุจู.</p>
                </div>
                <div class="space-y-2 text-sm mt-4">
                    <p><strong>ุฑูู ุงูุทูุจ:</strong> <span id="receipt-order-id"></span></p>
                    <p><strong>ุงุณู ุงูุนููู:</strong> <span id="receipt-customer-name"></span></p>
                    <p><strong>ุชุงุฑูุฎ ุงูุทูุจ:</strong> <span id="receipt-date"></span></p>
                    <p><strong>ุฑูู ุนูููุฉ ุงูุชุญููู:</strong> <span id="receipt-transaction-id" class="font-mono"></span></p>
                </div>
                <div class="mt-4 border-t pt-4">
                    <h3 class="font-bold mb-2">ุงูููุชุฌุงุช ุงููุทููุจุฉ:</h3>
                    <ul id="receipt-items" class="list-disc list-inside space-y-1 text-sm max-h-48 overflow-y-auto bg-gray-50 p-3 rounded">
                        <!-- Items will be injected here -->
                    </ul>
                </div>
                <div class="mt-4 border-t pt-4 text-center">
                    <p class="text-lg">ุงูุฅุฌูุงูู ุงููุฏููุน</p>
                    <p id="receipt-total" class="text-3xl font-extrabold"></p>
                </div>
                 <div class="mt-5 text-center text-xs text-gray-500 bg-gray-100 p-2 rounded-md">
                    <p class="font-semibold">ุดูุฑุงู ูุซูุชู ุจูุชุฌุฑ ููุงุทุนุฉ ุจูุณู!</p>
                    <p>ุณูุชู ูุฑุงุฌุนุฉ ุทูุจู ูุชุฃููุฏู ูู ุฃูุฑุจ ููุช.</p>
                </div>
            </div>
            <div class="p-4 bg-gray-100 rounded-b-lg flex gap-4 flex-shrink-0">
                <button onclick="sendReceiptEmail()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg">ุฅุฑุณุงู ููุจุฑูุฏ</button>
                <button onclick="showReviewModal()" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">ุชูููู ุงูููุชุฌุงุช</button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ูุชุงุจุฉ ุงูุชูููู -->
    <div id="review-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-gray-900 w-full max-w-2xl rounded-xl shadow-2xl border border-yellow-500/50 flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center p-5 border-b border-gray-800">
                <h3 class="text-2xl font-bold text-white">ุชูููู ุงูููุชุฌุงุช</h3>
                <button onclick="finalClose()" class="text-gray-500 hover:text-white transition duration-150">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div id="review-items-container" class="p-6 overflow-y-auto flex-grow space-y-4">
                <!-- ุณูุชู ููุก ูุฐุง ุจูุงุณุทุฉ JavaScript -->
            </div>
            <div class="p-4 bg-black/30 rounded-b-xl flex gap-4">
                <button onclick="finalClose()" class="flex-1 bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg">ุชุฎุทู</button>
                <button onclick="submitRatings()" class="flex-1 bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg">ุฅุฑุณุงู ุงูุชููููุงุช</button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุจูุงูุงุช ุงูุชุญููู ุงูุจููู -->
    <div id="bank-transfer-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-gray-900 w-full max-w-lg rounded-xl shadow-2xl border border-green-500/50">
            <div class="flex justify-between items-center p-5 border-b border-gray-800">
                <h3 class="text-2xl font-bold text-white">ุจูุงูุงุช ุงูุชุญููู ุงูุจููู</h3>
                <button onclick="closeBankTransferModal()" class="text-gray-500 hover:text-white transition duration-150">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div class="p-6 space-y-4">
                <div class="bg-gray-800 p-3 rounded-lg">
                    <p class="text-sm text-gray-400">ุงุณู ุงูุจูู</p>
                    <p class="text-lg font-bold text-white">ุจูู ุงูุจุฑู</p>
                </div>
                <div class="bg-gray-800 p-3 rounded-lg">
                    <p class="text-sm text-gray-400">ุงุณู ุงููุณุชููุฏ</p>
                    <p class="text-lg font-bold text-white">ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู</p>
                </div>
                <div class="bg-gray-800 p-3 rounded-lg">
                    <p class="text-sm text-gray-400">ุฑูู ุงูุญุณุงุจ (IBAN)</p>
                    <div class="flex justify-between items-center gap-2">
                        <p id="iban-number" class="text-lg font-bold text-yellow-400 font-mono tracking-wider">SA3430100991109025050211</p>
                        <button onclick="copyToClipboard(this, 'iban-number', 'ุชู ูุณุฎ ุงูุญุณุงุจ!')" class="relative bg-cyan-600 hover:bg-cyan-500 text-white text-xs font-bold py-1 px-3 rounded-md transition">ูุณุฎ</button>
                    </div>
                </div>
            </div>
            <div class="p-4 bg-black/30 rounded-b-xl">
                <button onclick="closeBankTransferModal()" class="w-full bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg">ุฅุบูุงู</button>
            </div>
        </div>
    </div>
    
    <!-- ูุงูุฐุฉ ุนุฑุถ ูุตู ุงูููุชุฌ -->
    <div id="description-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-gray-900 w-full max-w-2xl rounded-xl shadow-2xl border border-cyan-500/50">
            <div class="flex justify-between items-center p-5 border-b border-gray-800">
                <h3 id="description-modal-title" class="text-2xl font-bold text-white">ูุตู ุงูููุชุฌ</h3>
                <button onclick="closeDescriptionModal()" class="text-gray-500 hover:text-white transition duration-150">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div class="p-6">
                <p id="description-modal-content" class="text-gray-300 text-lg leading-relaxed whitespace-pre-wrap"></p>
            </div>
            <div class="p-4 bg-black/30 rounded-b-xl">
                <button onclick="closeDescriptionModal()" class="w-full bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-2 px-4 rounded-lg">ุฅุบูุงู</button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงููุนุงููุฉ ุงูุณุฑูุนุฉ -->
    <div id="quick-preview-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-gray-900 w-full max-w-5xl rounded-2xl shadow-2xl border border-cyan-500/50 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center p-5 border-b border-gray-800 sticky top-0 bg-gray-900 z-10">
                <h3 class="text-2xl font-bold text-white">ูุนุงููุฉ ุณุฑูุนุฉ</h3>
                <button onclick="closeQuickPreview()" class="text-gray-500 hover:text-white transition duration-150">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div id="quick-preview-content" class="p-6">
                <!-- ุณูุชู ููุก ุงููุญุชูู ููุง -->
            </div>
        </div>
    </div>

    <!-- ุฒุฑ ุงูุจูุช ุงูุนุงุฆู -->
    <button id="help-bot-button" class="fixed bottom-6 left-6 z-40 bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-400 hover:to-orange-400 text-white px-4 py-3 rounded-full shadow-2xl transition-all duration-300 transform hover:scale-110 animate-bounce flex items-center gap-3" title="ูุณุงุนุฏ ุงูุดุฑุงุก">
        <img src="https://i.postimg.cc/cH21G5hv/017ce4679e425014.gif" alt="ุจูุช" class="w-10 h-10 rounded-full">
        <span class="font-black text-xl">ุจูุช ุจูุณู</span>
        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center animate-pulse shadow-lg">?</span>
    </button>

    <!-- ูุงูุฐุฉ ุจูุช ุงููุณุงุนุฏุฉ -->
    <div id="help-bot-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-gradient-to-br from-gray-900 to-gray-800 w-full max-w-2xl rounded-2xl shadow-2xl border-2 border-yellow-500/50 flex flex-col max-h-[90vh]">
            <!-- ุฑุฃุณ ุงููุงูุฐุฉ -->
            <div class="flex justify-between items-center p-6 border-b-2 border-yellow-500/30 bg-gradient-to-r from-yellow-600/20 to-orange-600/20">
                <div class="flex items-center gap-3">
                    <div class="bg-yellow-500 p-2 rounded-full animate-bounce">
                        <svg class="w-6 h-6 text-black" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg>
                    </div>
                    <div>
                        <h3 class="text-2xl font-black text-yellow-400">ูุณุงุนุฏ ุงูุดุฑุงุก</h3>
                        <p class="text-xs text-gray-400">ุฏูููู ุงูุดุงูู ููุดุฑุงุก ูุงูุงุณุชูุงู</p>
                    </div>
                </div>
                <button onclick="closeHelpBot()" class="text-gray-500 hover:text-white transition duration-150 hover:rotate-90 transform">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            
            <!-- ูุญุชูู ุงูุจูุช -->
            <div class="p-6 overflow-y-auto flex-grow space-y-6">
                <!-- ุงูุฎุทูุฉ 1 -->
                <div class="bg-gray-800/50 p-5 rounded-xl border-l-4 border-cyan-500 hover:bg-gray-800 transition">
                    <div class="flex items-start gap-4">
                        <div class="bg-cyan-500 text-black font-black text-xl w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0">1</div>
                        <div class="flex-grow">
                            <h4 class="text-xl font-bold text-cyan-400 mb-2">๐ ุงุฎุชุฑ ููุชุฌุงุชู</h4>
                            <p class="text-gray-300 leading-relaxed">ุชุตูุญ ูู ุงููุชุฌุฑ ูุงุฎุชุฑ ุงูููุชุฌุงุช ุงูุชู ุชุฑูุฏูุง. ุงุถุบุท ุนูู ุฒุฑ <span class="text-cyan-400 font-bold">"ุฃุถู ููุณูุฉ"</span> ููู ููุชุฌ.</p>
                        </div>
                    </div>
                </div>

                <!-- ุงูุฎุทูุฉ 2 -->
                <div class="bg-gray-800/50 p-5 rounded-xl border-l-4 border-blue-500 hover:bg-gray-800 transition">
                    <div class="flex items-start gap-4">
                        <div class="bg-blue-500 text-black font-black text-xl w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0">2</div>
                        <div class="flex-grow">
                            <h4 class="text-xl font-bold text-blue-400 mb-2">๐๏ธ ุงูุชุญ ุณูุฉ ุงูุชุณูู</h4>
                            <p class="text-gray-300 leading-relaxed">ุงุถุบุท ุนูู ุฃููููุฉ ุงูุณูุฉ ๐๏ธ ูู ุฃุนูู ุงูุตูุญุฉ. ุฑุงุฌุน ูุดุชุฑูุงุชู ูุงุถุบุท <span class="text-blue-400 font-bold">"ุฅุชูุงู ุนูููุฉ ุงูุดุฑุงุก"</span>.</p>
                        </div>
                    </div>
                </div>

                <!-- ุงูุฎุทูุฉ 3 -->
                <div class="bg-gray-800/50 p-5 rounded-xl border-l-4 border-purple-500 hover:bg-gray-800 transition">
                    <div class="flex items-start gap-4">
                        <div class="bg-purple-500 text-black font-black text-xl w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0">3</div>
                        <div class="flex-grow">
                            <h4 class="text-xl font-bold text-purple-400 mb-2">โ๏ธ ุฃุฏุฎู ุจูุงูุงุชู</h4>
                            <p class="text-gray-300 leading-relaxed mb-3">ุงููุฃ ุงููููุฐุฌ ุจูุนูููุงุชู:</p>
                            <ul class="list-disc list-inside text-gray-400 space-y-1 mr-4">
                                <li>ุงุณูู ุฏุงุฎู ุงููุนุจุฉ (ููู ุฌุฏุงู!)</li>
                                <li>ุจุฑูุฏู ุงูุฅููุชุฑููู</li>
                                <li>ุฑูู ูุงุชูู</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- ุงูุฎุทูุฉ 4 -->
                <div class="bg-gray-800/50 p-5 rounded-xl border-l-4 border-green-500 hover:bg-gray-800 transition">
                    <div class="flex items-start gap-4">
                        <div class="bg-green-500 text-black font-black text-xl w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0">4</div>
                        <div class="flex-grow">
                            <h4 class="text-xl font-bold text-green-400 mb-2">๐ณ ุงุฏูุน ุงููุจูุบ</h4>
                            <p class="text-gray-300 leading-relaxed mb-3">ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน:</p>
                            <div class="grid grid-cols-2 gap-3">
                                <div class="bg-blue-600/20 p-3 rounded-lg border border-blue-500/30">
                                    <p class="text-blue-400 font-bold">PayPal</p>
                                    <p class="text-xs text-gray-400">ุฏูุน ููุฑู ูุขูู</p>
                                </div>
                                <div class="bg-green-600/20 p-3 rounded-lg border border-green-500/30">
                                    <p class="text-green-400 font-bold">ุชุญููู ุจููู</p>
                                    <p class="text-xs text-gray-400">ุนุจุฑ ุจูู ุงูุจุฑู</p>
                                </div>
                            </div>
                            <p class="text-yellow-400 text-sm mt-3 font-bold">โ๏ธ ููู: ุงุญุชูุธ ุจุฑูู ุนูููุฉ ุงูุชุญููู ูุฃุฏุฎูู ูู ุงูุญูู ุงููุฎุตุต!</p>
                        </div>
                    </div>
                </div>

                <!-- ุงูุฎุทูุฉ 5 -->
                <div class="bg-gray-800/50 p-5 rounded-xl border-l-4 border-yellow-500 hover:bg-gray-800 transition">
                    <div class="flex items-start gap-4">
                        <div class="bg-yellow-500 text-black font-black text-xl w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0">5</div>
                        <div class="flex-grow">
                            <h4 class="text-xl font-bold text-yellow-400 mb-2">๐ซ ุงุณุชูู ุงูุฅูุตุงู</h4>
                            <p class="text-gray-300 leading-relaxed mb-3">ุจุนุฏ ุชุฃููุฏ ุงูุทูุจุ ุณุชุญุตู ุนูู <span class="text-yellow-400 font-black">ููุฏ ุชุญูู</span> ูุฑูุฏ ูุซู:</p>
                            <div class="bg-cyan-900/30 border-2 border-dashed border-cyan-500 p-4 rounded-lg text-center">
                                <p class="text-4xl font-black text-cyan-400 font-mono tracking-widest">PX-A7K9M2</p>
                            </div>
                            <p class="text-red-400 text-sm mt-3 font-bold">โ๏ธ ุงุญูุธ ูุฐุง ุงูููุฏ! ุณุชุญุชุงุฌู ูุงุณุชูุงู ููุชุฌุงุชู</p>
                        </div>
                    </div>
                </div>

                <!-- ุงูุฎุทูุฉ 6 -->
                <div class="bg-gray-800/50 p-5 rounded-xl border-l-4 border-pink-500 hover:bg-gray-800 transition">
                    <div class="flex items-start gap-4">
                        <div class="bg-pink-500 text-black font-black text-xl w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0">6</div>
                        <div class="flex-grow">
                            <h4 class="text-xl font-bold text-pink-400 mb-2">๐ฌ ุชูุงุตู ูุน ุงูุฏุนู</h4>
                            <p class="text-gray-300 leading-relaxed mb-3">ุงูุชุญ ุชุฐูุฑุฉ ูู ุฏูุณููุฑุฏ ููุงุทุนุฉ ุจูุณู ููุฏู:</p>
                            <ul class="list-disc list-inside text-gray-400 space-y-1 mr-4">
                                <li>ููุฏ ุงูุชุญูู ุงูุฎุงุต ุจู</li>
                                <li>ุงุณูู ุฏุงุฎู ุงููุนุจุฉ</li>
                                <li>ุฑูู ุนูููุฉ ุงูุชุญููู</li>
                            </ul>
                            <a href="https://discord.gg/pxll" target="_blank" class="inline-flex items-center gap-2 bg-[#5865F2] hover:bg-[#4f5bda] text-white font-bold py-3 px-6 rounded-lg mt-4 transition transform hover:scale-105">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.317 4.37a19.791 19.791 0 00-4.885-1.515.074.074 0 00-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 00-5.487 0 12.64 12.64 0 00-.617-1.25.077.077 0 00-.079-.037A19.736 19.736 0 003.677 4.37a.07.07 0 00-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 00.031.057 19.9 19.9 0 005.993 3.03.078.078 0 00.084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 00-.041-.106 13.107 13.107 0 01-1.872-.892.077.077 0 01-.008-.128 10.2 10.2 0 00.372-.292.074.074 0 01.077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 01.078.01c.12.098.246.198.373.292a.077.077 0 01-.006.127 12.299 12.299 0 01-1.873.892.077.077 0 00-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 00.084.028 19.839 19.839 0 006.002-3.03.077.077 0 00.032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 00-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"></path></svg>
                                ุงูุชุญ ุชุฐูุฑุฉ ุฏุนู
                            </a>
                        </div>
                    </div>
                </div>

                <!-- ุงูุฎุทูุฉ 7 -->
                <div class="bg-gradient-to-r from-green-900/30 to-emerald-900/30 p-5 rounded-xl border-2 border-green-500 hover:shadow-lg hover:shadow-green-500/20 transition">
                    <div class="flex items-start gap-4">
                        <div class="bg-green-500 text-black font-black text-xl w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0">โ</div>
                        <div class="flex-grow">
                            <h4 class="text-xl font-bold text-green-400 mb-2">๐ ุงุณุชูู ููุชุฌุงุชู</h4>
                            <p class="text-gray-300 leading-relaxed">ุจุนุฏ ูุฑุงุฌุนุฉ ุงูุฏุนู ูุทูุจูุ ุณูุชู ุชุณููู ุงูููุชุฌุงุช ูู ุฏุงุฎู ุงููุนุจุฉ. ุงุณุชูุชุน ุจูุดุชุฑูุงุชู! ๐</p>
                        </div>
                    </div>
                </div>

                <!-- ูุตุงุฆุญ ุฅุถุงููุฉ -->
                <div class="bg-blue-900/20 border border-blue-500/30 p-4 rounded-lg">
                    <h5 class="text-lg font-bold text-blue-400 mb-2">๐ก ูุตุงุฆุญ ูููุฉ:</h5>
                    <ul class="text-gray-300 space-y-2 text-sm">
                        <li>โข ุชุฃูุฏ ูู ุฅุฏุฎุงู ุงุณูู ุงูุตุญูุญ ุฏุงุฎู ุงููุนุจุฉ</li>
                        <li>โข ุงุญุชูุธ ุจููุทุฉ ุดุงุดุฉ ููุฅูุตุงู ูููุฏ ุงูุชุญูู</li>
                        <li>โข ููุช ุงููุนุงูุฌุฉ ุนุงุฏุฉ ูู 5-30 ุฏูููุฉ</li>
                        <li>โข ูุง ุชุดุงุฑู ููุฏ ุงูุชุญูู ูุน ุฃู ุดุฎุต</li>
                    </ul>
                </div>
            </div>
            
            <!-- ุชุฐููู ุงููุงูุฐุฉ -->
            <div class="p-4 bg-black/30 rounded-b-2xl border-t border-yellow-500/30">
                <button onclick="closeHelpBot()" class="w-full bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white font-bold py-3 px-6 rounded-lg transition transform hover:scale-105">
                    ูููุช! ููุจุฏุฃ ุงูุชุณูู ๐
                </button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงูุดุฑูุท ูุงูุฃุญูุงู (Legal Modal) -->
    <div id="legal-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-gray-900 w-full max-w-4xl h-[90vh] rounded-xl shadow-2xl border border-cyan-500/50 flex flex-col">
            <!-- ุฑุฃุณ ุงููุงูุฐุฉ -->
            <div class="flex justify-between items-center p-5 border-b border-gray-800 flex-shrink-0">
                <h3 id="legal-modal-title" class="text-2xl font-bold text-white">ุงูุดุฑูุท ูุงูุฃุญูุงู</h3>
                <button onclick="closeLegalModal()" class="text-gray-500 hover:text-white transition duration-150">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <!-- ูุญุชูู ุงููุงูุฐุฉ ุงููุงุจู ููุชูุฑูุฑ -->
            <div id="legal-modal-content" class="p-6 md:p-8 overflow-y-auto flex-grow text-gray-300 space-y-6">
                <h4 class="text-xl font-bold text-cyan-400">ุงูููุฏูุฉ</h4>
                <p>ูุชุฌุฑ ุณูุฑูุฑ ููุงุทุนุฉ ุจูุณู ูุจูุน ุงูููุชุฌุงุช ุงูุฑูููุฉ ููุนุจุฉ ูุงูู ุฅู ุงูุฅููุชุฑูููุฉ ูุฑุญูุจ ุจููุ ููุจูุบูู ุจุฃููู ุณูู ุชุฌุฏูู ุฃุฏูุงู ุงูุดุฑูุท ูุงูุฃุญูุงู ุงููููุธููุฉ ูุงุณุชุฎุฏุงููู ููุฐุง ุงููุชุฌุฑ ููุงูุฉ ุงูุขุซุงุฑ ุงููุงููููุฉ ุงููุชุฑุชุจุฉ ุนูู ุงุณุชุฎุฏุงููู ูุฎุฏูุงุชู ุนุจุฑ ูุฐู ุงูููุตุฉ ุงูุฅููุชุฑูููุฉ.</p>
                <p>ุฅู ุงุณุชุฎุฏุงู ุฃู ุดุฎุต ูููุชุฌุฑุ ุณูุงุก ูุงู ูุณุชููููุง ูุฎุฏูุฉ ุฃู ููุชุฌุ ููุนุฏ ุงุณุชุฎุฏุงูู ููุงููุฉ ููุจูููุง ุชุงููุง ุจุฌููุน ููุงุฏ ูุฃุญูุงู ูุฐู ุงูุงุชูุงููุฉุ ูุฅูุฑุงุฑูุง ููู ุจูุงูู ุฃูููุชู ุงูุดุฑุนูุฉ ูุงููุธุงููุฉ ูุงููุงููููุฉ ูุงูุชุฒุงูู ุจูุง ูุฑุฏ ูููุง.</p>
                <p>ุชุณุฑู ูุฐู ุงูุงุชูุงููุฉ ุนูู ุฌููุน ุฃููุงุน ุงูุชุนุงูู ุจูู ุงููุณุชููู ูุงููุชุฌุฑุ ูุชุนุชุจุฑ ุณุงุฑูุฉ ุงูููุนูู ุจูุฌุฑุฏ ููุงููุชูู ุนูููุง ูุงูุจุฏุก ูู ุงูุชุณุฌููุ ููููุง ูููุงุฏุฉ ุงูุนุงุดุฑุฉ ูู ูุธุงู ุงูุชุนุงููุงุช ุงูุฅููุชุฑูููุฉ ุงูุณุนูุฏู.</p>

                <h4 class="text-xl font-bold text-cyan-400 pt-4 border-t border-gray-700">ุจููุฏ ุฎุงุตุฉ ุจููุงููู ุงูุณูุฑูุฑ โ ููุงุทุนุฉ ุจูุณู</h4>
                <ul class="list-disc list-inside space-y-2">
                    <li>ุฃูุฑู ุจุฃูู ูู ุญุงู ุชู ุญุธุฑู (ุชุจููุฏู) ูู ุณูุฑูุฑ ููุงุทุนุฉ ุจูุณู ูุชูุฌุฉ ูุฎุงููุฉ ููุงููู ุงูุณูุฑูุฑ ุจุนุฏ ุงูุจุฏุก ูู ุงูุงุณุชูุงุฏุฉ ูู ุงูุฎุฏูุฉุ ูุฅูู ูุง ูุญู ูู ุงููุทุงูุจุฉ ุจุฃู ูุจุงูุบ ูุงููุฉ ูุฏููุนุฉุ ูุธุฑูุง ูุฃู ุงูุฎุฏูุฉ ุฑูููุฉ ูุณุชูููุฉ ูุบูุฑ ูุงุจูุฉ ููุงุณุชุฑุฌุงุน.</li>
                    <li>ูุนุชุจุฑ ุงูุญุธุฑ ููุนุถู ูู ุฅุฏุงุฑุฉ ุงูุณูุฑูุฑ ูุฎุงููุฉ ุตุฑูุญุฉ ูููุงููู ุงูุณูุฑูุฑุ ููุญู ูุฅุฏุงุฑุฉ ููุงุทุนุฉ ุจูุณู ุชุตููุฑ (ุญุฐู) ูุงูู ุญุณุงุจู ุฏุงุฎู ุงูุณูุฑูุฑ ูุญุธุฑู ููุงุฆููุง.</li>
                    <li>ููููุญ ุงูุนุถู ุงููุญุธูุฑ ุฃู ุงููุตููุฑ ุญู ุงูุงุนุชุฑุงุถ ุฎูุงู ูุฏุฉ ูุง ุชุชุฌุงูุฒ ( 7 ุฃูุงู ) ูู ุชุงุฑูุฎ ุชูููุฐ ุงูุนููุจุฉุ ุนูู ุฃู ูุชู ุชูุฏูู ุงูุงุนุชุฑุงุถ ุญุตุฑููุง ุนุจุฑ ูุชุญ ุชุฐูุฑุฉ ูู ุจุฑูุงูุฌ ุงูุฏูุณููุฑุฏ ุงูุฎุงุต ุจุงูุณูุฑูุฑ.</li>
                    <li>ุชูุชุฒู ุงูุฅุฏุงุฑุฉ ุฎูุงู ูุฐู ุงููุฏุฉ ุจุชูุถูุญ ุณุจุจ ุงูุญุธุฑ ุฃู ุงูุชุตููุฑ ููุนุถูุ ููููู ุงูุชูุถูุญ ุจุฃุญุฏ ุงูุฃุดูุงู ุงูุชุงููุฉ: 1-ูุต ููุชูุจุ 2-ุตูุฑุฉุ 3-ููุทุน ููุฏููุ ุฃู 4- ุจุดูู ุตูุชู , ุนุจุฑ ุงููุญุงุฏุซุฉ ุงููุจุงุดุฑุฉ ูู ุงูุฏูุณููุฑุฏ ุจูู ุงูุฅุฏุงุฑุฉ ูุงูุนุถู ุงููุฎุงูู.</li>
                    <li>ูู ุญุงู ูุงูุช ุงูุฅุฏุงุฑุฉ ุจุชูุถูุญ ุณุจุจ ุงููุฎุงููุฉ ุงููุฑุชูุจุฉุ ูุฅู ุงููุฑุงุฑ ููุนุฏ ููุงุฆููุง ูููุฒููุง ุฏุงุฎู ุงูุณูุฑูุฑ ููุง ูุญู ููุนุถู ุงูุงุนุชุฑุงุถ ุนููู ูุฑุฉ ุฃุฎุฑู ุฏุงุฎู ุงูุณูุฑูุฑ.</li>
                    <li>ุงูุนุถู ุงูุฐู ูุชู ุญุธุฑู ุจุณุจุจ ูุฎุงููุงุช ูุชูุฑุฑุฉุ ุฃู ุชุณุจุจ ุจูุดุงูู ููุงุนุจูู ุงูุขุฎุฑููุ ุฃู ูุญุงููุงุช ุงููุถุงููุฉ ูุงูุชุฎุฑูุจ ูู ุจูุฆุฉ ุงููุนุจุ ูุฅู ููุฅุฏุงุฑุฉ ูุงูู ุงูุญู ูู ุงุชุฎุงุฐ ุฅุฌุฑุงุก ููุงุฆู ูุชูุซู ูู ุญุธุฑ ูุชุตููุฑ ูุงูู ุญุณุงุจู.</li>
                    <li>ุงูุจุงูุฏ ( ุงูุญุธุฑ ) ูุชู ุนูู ูู ูู ุงุฑุชูุจ ุงูุฃูุนุงู ุงูุขุชูุฉ ุนูู ุณุจูู ุงููุซุงู ูุง ุงูุญุตุฑ: ุงูุณุจ ุฃู ุงูุดุชูุ ุงูุชุดููุฑุ ุงููุฐูุ ุงูุฅุณุงุกุฉ ุงูููุธูุฉ ุฃู ุงููุนููุฉุ ุงุณุชุนูุงู ุซุบุฑุงุชุ ูุถุงููุฉ ุงููุงุนุจููุ ุฃู ุฃู ูุฎุงููุฉ ุฃุฎุฑู ุชุคุซุฑ ุนูู ุงููุนุจุฉ ูุฅุฏุงุฑุฉ ุงูุณูุฑูุฑ ูู ูู ุชุญุฏุฏ ุงูุฃุซุฑ.</li>
                </ul>

                <h4 class="text-xl font-bold text-cyan-400 pt-4 border-t border-gray-700">ุจูุฏ ุงุณุชุนูุงู ููุงุฏ ุงูุบุด</h4>
                <p>ุจุนุฏ ุดุฑุงุก ููุชุฌ (ุชุฐูุฑุฉ ุงุณุชุนูุงู ููุงุฏ ุบุด) ูู ุงููุชุฌุฑุ ูููุฑ ุงููุงุนุจ ูููุงูู ุนูู ูุง ููู:</p>
                <ul class="list-disc list-inside space-y-2">
                    <li>ูุง ูุญู ูู ุงููุทุงูุจุฉ ุจุฃู ุงุณุชุฑุฏุงุฏ ูุงูู ุฃู ุชุนููุถ ุจุนุฏ ุชูููุฐ ุงูุนููุจุฉุ ุจุงุนุชุจุงุฑ ุฃู ุงูุฎุฏูุฉ ุฑูููุฉ ูุณุชูููุฉ.</li>
                    <li>ููุงูู ุนูู ุชุตููุฑ ุญุณุงุจู ุจุงููุงูู.</li>
                    <li>ูุชู ุณุญุจ ุฌููุน ููุชููุงุชู ูู ุงููุชุฌุฑ ููู ุฏุงุฎู ุงูุณูุฑูุฑ ุจุดูู ููุงุฆู ุฏูู ุฃู ุงุณุชุซูุงุก.</li>
                    <li>ูุง ูุญู ูู ุงููุทุงูุจุฉ ุจุฃู ูุจุงูุบ ูุงููุฉ ุฃู ุชุนููุถุงุช ุฏุงุฎู ุงูุณูุฑูุฑ ุชุญุช ุฃู ุธุฑู.</li>
                </ul>

                <h4 class="text-xl font-bold text-cyan-400 pt-4 border-t border-gray-700">ุณูุงุณุฉ ุงูุงุณุชุฑุฌุงุน ูุงูุงุณุชุจุฏุงู</h4>
                <ul class="list-disc list-inside space-y-2">
                    <li>ูุง ูุชู ุงูุงุณุชุฑุฌุงุน ุฃู ุงูุงุณุชุจุฏุงู ุฅูุง ูู ุญุงู ูุงู ุงูููุชุฌ ูุฎุชูููุง ุนู ุงููุตู ุฃู ูู ุญุงู ูุฌูุฏ ุฎูู ูููุน ุงูุงุณุชูุงุฏุฉ ููู.</li>
                    <li>ูุฌุจ ุชูุฏูู ุงูุฏููู ุจุงูุชุตููุฑ ุนุจุฑ ูุชุญ ุชุฐูุฑุฉ ูู ุจุฑูุงูุฌ ุงูุฏูุณููุฑุฏ ุงูุฎุงุต ุจุงูุณูุฑูุฑ ุฎูุงู ูุฏุฉ ูุง ุชุชุฌุงูุฒ ( 7ุฃูุงู ) ูู ุงุณุชูุงู ุงูููุชุฌ.</li>
                    <li>ูุง ูุชู ุงูุงุณุชุจุฏุงู ุจูุงุกู ุนูู ุงุฎุชูุงู ุงูุฐูู ุฃู ุชุบููุฑ ุงูุฑุฃู ุจุนุฏ ุงุณุชูุงู ุงูููุชุฌ ุทุงููุง ุฃูู ูุทุงุจู ูููุตู ุงููุฐููุฑ.</li>
                </ul>

                <h4 class="text-xl font-bold text-cyan-400 pt-4 border-t border-gray-700">ูุณุคูููุงุช ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู ุชุฌุงู ุงูุนููู</h4>
                <ul class="list-disc list-inside space-y-2">
                    <li>ูุณุคูููุฉ ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู ุชูุชูู ุจุนุฏ ุชุณููู ููุฏ ุงูููุชุฌ ุจุดูู ุตุญูุญ.</li>
                    <li>ุงูุนููู ูุณุคูู ุนู ุงุฎุชูุงุฑ ุงูููุชุฌ ูุฅุฏุฎุงู ุฑูู ุงูุฌูุงู ูุงูุฅูููู ุงูุตุญูุญ ุนูุฏ ุงูุทูุจุ ููุณุคูู ุนู ููุฏ ุงูููุชุฌ ุจุนุฏ ุงุณุชูุงูู ููู ูุง ูุชุฑุชุจ ุนููู ูู ุงุณุชุฎุฏุงูุงุช ูุงุญูุฉ.</li>
                    <li>ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู ุบูุฑ ูุณุคูู ุนู ุฅุฏุฎุงู ุงูุนููู ููุนูููุงุช ุฎุงุทุฆุฉุ ููู ุญุงู ุงูุญุงุฌุฉ ูุฅุนุงุฏุฉ ุงูุฅุฑุณุงู ูุชุญูู ุงูุนููู ุงูุฑุณูู ุงูุฅุถุงููุฉ.</li>
                    <li>ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู ุบูุฑ ูุณุคูู ุนู ุฃู ุงุณุชุฎุฏุงู ุฎุงุทุฆ ููููุชุฌ ุฃู ุณูุก ุงุณุชุนูุงู.</li>
                    <li>ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู ุบูุฑ ูุณุคูู ุนู ุฃู ุชูุณูุฑ ุดุฎุตู ุฃู ุงุณุชุฎุฏุงู ุบูุฑ ููุงุณุจ ูููุญุชูู ุงููุนุฑูุถ ุฃู ุจุณุจุจ ููู ุงูุนููู ุงูุฎุงุทุฆ ูุทุจูุนุฉ ุงูููุชุฌุงุช.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ุชุฐููู ุงูุตูุญุฉ (Footer) - ุจุณูุท ูููู -->
    <footer class="bg-black border-t border-cyan-500/50 text-white mt-16 py-10 shadow-inner shadow-gray-900/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center text-center md:text-right">
                <div class="mb-4 md:mb-0">
                    <p class="text-2xl font-bold text-cyan-500">ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู</p>
                </div>
                <div class="flex items-center gap-4">
                    <!-- YouTube -->
                    <a href="https://www.youtube.com/@wek5" target="_blank" class="bg-[#FF0000] hover:bg-[#cc0000] text-white p-3 rounded-full transition duration-300 transform hover:scale-110" title="ููุงุชูุง ุนูู ููุชููุจ">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M10,15L15.19,12L10,9V15M21.56,7.17C21.69,7.64 21.78,8.27 21.84,9.07C21.91,9.87 21.94,10.56 21.94,11.16L22,12C22,14.19 21.84,15.8 21.56,16.83C21.31,17.73 20.73,18.31 19.83,18.56C19.36,18.69 18.5,18.78 17.18,18.84C15.88,18.91 14.69,18.94 13.59,18.94L12,19C7.81,19 5.2,18.84 3.17,18.56C2.27,18.31 1.69,17.73 1.44,16.83C1.31,16.36 1.22,15.73 1.16,14.93C1.09,14.13 1.06,13.44 1.06,12.84L1,12C1,9.81 1.16,8.2 1.44,7.17C1.69,6.27 2.27,5.69 3.17,5.44C3.64,5.31 4.5,5.22 5.82,5.16C7.12,5.09 8.31,5.06 9.41,5.06L11,5C15.19,5 17.8,5.16 19.83,5.44C20.73,5.69 21.31,6.27 21.56,7.17Z"></path></svg>
                    </a>
                    <!-- TikTok -->
                    <a href="https://www.tiktok.com/@iiiwek?is_from_webapp=1&sender_device=pc" target="_blank" class="bg-gray-800 hover:bg-gray-700 p-2 rounded-full transition duration-300 transform hover:scale-110" title="ุญุณุงุจูุง ุนูู ุชูู ุชูู">
                        <img src="https://i.postimg.cc/SK6Fxyhp/tik-tok.png" alt="TikTok" class="w-8 h-8">
                    </a>
                    <!-- Discord -->
                    <a href="https://discord.gg/pxll" target="_blank" class="bg-[#5865F2] hover:bg-[#4f5bda] text-white font-bold py-3 px-6 rounded-lg transition duration-300 transform hover:scale-105 flex items-center gap-3">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.317 4.36981C18.7915 3.08433 16.981 2.04883 15 1.41016V1.41016C15 1.41016 14.9459 1.35608 14.8918 1.35608C14.8376 1.35608 14.7835 1.41016 14.7835 1.41016C13.258 1.99475 11.8447 2.57935 10.5436 3.21802C8.90246 2.52527 7.14916 1.93054 5.28241 1.41016C5.22833 1.35608 5.17425 1.35608 5.12018 1.41016C4.95385 1.41016 4.8457 1.51831 4.79162 1.68054C3.03833 4.92004 2.4436 8.26764 3.19043 11.457C3.19043 11.457 3.19043 11.5111 3.24451 11.5652C3.29858 11.6192 3.35266 11.6192 3.35266 11.6192C4.43414 11.1529 5.46155 10.7407 6.43489 10.2744C6.48896 10.2203 6.48896 10.1662 6.43489 10.1122C6.01147 9.75398 5.64215 9.3418 5.3269 8.87556C5.27283 8.82148 5.16467 8.82148 5.1106 8.87556C5.05652 8.92964 5.05652 9.03779 5.1106 9.09187C5.58801 9.67646 6.11951 10.207 6.651 10.6732C6.70508 10.7273 6.75916 10.7273 6.81323 10.7273C10.1068 12.5378 13.8932 12.5378 17.1868 10.7273C17.2408 10.7273 17.2949 10.7273 17.349 10.6732C17.8805 10.207 18.412 9.67646 18.8894 9.09187C18.9435 9.03779 18.9435 8.92964 18.8894 8.87556C18.8353 8.82148 18.7272 8.82148 18.6731 8.87556C18.3579 9.3418 17.9885 9.75398 17.5651 10.1122C17.511 10.1662 17.511 10.2203 17.5651 10.2744C18.5384 10.7407 19.5659 11.1529 20.6473 11.6192C20.6473 11.6192 20.7014 11.6192 20.7555 11.5652C20.8096 11.5111 20.8096 11.457 20.8096 11.457C21.6646 7.94728 21.3494 4.92004 20.317 4.36981ZM8.02008 9.39587C7.32733 9.39587 6.78662 8.86536 6.78662 8.17261C6.78662 7.47986 7.32733 6.94934 8.02008 6.94934C8.71283 6.94934 9.25354 7.47986 9.25354 8.17261C9.25354 8.86536 8.71283 9.39587 8.02008 9.39587ZM15.9799 9.39587C15.2872 9.39587 14.7465 8.86536 14.7465 8.17261C14.7465 7.47986 15.2872 6.94934 15.9799 6.94934C16.6727 6.94934 17.2134 7.47986 17.2134 8.17261C17.2134 8.86536 16.6727 9.39587 15.9799 9.39587Z"></path></svg>
                        <span>ุฏูุณููุฑุฏ ููุงุทุนุฉ ุจูุณู</span>
                    </a>
                </div>
            </div>
            <div class="text-center mt-8 pt-8 border-t border-gray-800">
                <div class="flex justify-center space-x-8 space-x-reverse text-base text-white mb-4">
                     <a href="#" onclick="showLegalModal('ุงูุดุฑูุท ูุงูุฃุญูุงู')" class="hover:text-cyan-400 transition duration-150">ุงูุดุฑูุท ูุงูุงุญูุงู</a>
                     <a href="#" onclick="showLegalModal('ุณูุงุณุฉ ุงูุงุณุชุฑุฌุงุน')" class="hover:text-cyan-400 transition duration-150">ุณูุงุณุฉ ุงูุงุณุชุฑุฌุงุน</a>
                     <a href="#" onclick="showLegalModal('ุณูุงุณุฉ ุงููุชุฌุฑ')" class="hover:text-cyan-400 transition duration-150">ุณูุงุณุฉ ุงููุชุฌุฑ</a>
                </div>
                <div class="flex justify-center items-center gap-4 mt-4">
                    <img src="https://cdn.salla.network/cdn-cgi/image/fit=scale-down,width=58,height=58,onerror=redirect,format=auto/images/payment/mada_mini.png" alt="Mada" class="h-8">
                    <img src="https://cdn.salla.network/cdn-cgi/image/fit=scale-down,width=58,height=58,onerror=redirect,format=auto/images/payment/credit_card_mini.png" alt="Credit Card" class="h-8">
                    <img src="https://cdn.salla.network/cdn-cgi/image/fit=scale-down,width=58,height=58,onerror=redirect,format=auto/images/payment/bank_mini.png" alt="Bank Transfer" class="h-8">
                </div>
                <p class="text-base text-white font-semibold mt-4">
                    &copy; 2025 ุญููู ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู
                </p>
            </div>
        </div>
    </footer>

    <!-- JavaScript ูุชูุนูู ุงูุชููู ุจูู ุงูุตูุญุงุช ุงูุฏููุงููููุฉ (SPA) -->
    <script>
        // === ุฅุนุฏุงุฏ ุงูุงุชุตุงู ุจู JSONBin.io ===
        let allProducts = {};

        // ุชุญููู ุงูุจูุงูุงุช ูู Supabase
        async function loadProducts() {
            try {
                allProducts = await supabaseAPI.getAllData();
                
                if (allProducts.maintenanceMode && allProducts.maintenanceMode.isActive) {
                    // ุงูุชุญูู ูู ุชููู ุงูุฃุฏูู
                    const urlParams = new URLSearchParams(window.location.search);
                    const adminPreview = urlParams.get('admin_preview');
                    const savedToken = sessionStorage.getItem('admin_preview_token');
                    
                    if (adminPreview && adminPreview === savedToken) {
                        // ุงูุณูุงุญ ููุฃุฏูู ุจุงูุฏุฎูู
                        console.log('ุฏุฎูู ุงูุฃุฏูู ูู ูุถุน ุงูุตูุงูุฉ');
                    } else {
                        // ุนุฑุถ ุตูุญุฉ ุงูุตูุงูุฉ ููุฒูุงุฑ ุงูุนุงุฏููู
                        renderMaintenancePage(allProducts.maintenanceMode.message);
                        return false;
                    }
                }
                if (allProducts.sale) {
                    appState.sale = allProducts.sale;
                }
                return true;
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชุญููู ุงูุจูุงูุงุช:', error);
                return false;
            }
        }


        // === ุญุงูุฉ ุงูุชุทุจูู (SPA State) ===
        let logoClickCount = 0;
        let appState = {
            currentPage: 'home',
            currentOrderForReview: null,
            cart: [],
            filters: {
                vehicleCategory: 'all',
                investmentCategory: 'all',
                investmentRegion: 'all'
            },
            sale: {
                isActive: false,
                percentage: 0
            },
            appliedDiscount: {
                code: null,
                percentage: 0,
                target: { type: 'all', value: null }
            },
            currentCurrency: 'SAR',
            conversionRates: {
                'USD': 1,
                'SAR': 3.75,
                'AED': 3.67,
                'KWD': 0.31,
                'BHD': 0.38,
                'OMR': 0.38,
                'QAR': 3.64,
                'IQD': 1310,
                'JOD': 0.71
            }
        };

        // === ูุธุงุฆู ุงูุนุฑุถ (Render Functions) ===

        // ุฏุงูุฉ ูุฎูุท ุงููุตูููุฉ ุจุดูู ุนุดูุงุฆู
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // 1. ุนุฑุถ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
        function renderHomePage() {
            // ุจุทุงูุงุช ุฃุจุฑุฒ ุงูููุชุฌุงุช
            const featuredCards = [
                {
                    title: 'ุงูุณูุงุฑุงุช ุงููุงุฎุฑุฉ',
                    description: 'ุงูุชูู ุฃูุฏุฑ ูุฃููู ุงูุณูุงุฑุงุช ุงููุฎุตุตุฉ ูุชุนุฒูุฒ ุญุถูุฑู ูููุจุชู ูู ุจูุณู.',
                    image: 'https://i.postimg.cc/zG46FZxt/639fc85a9cb57582a2b72cea14b997692eb25dd7.png',
                    link: 'vehicles'
                },
                {
                    title: 'ุงููุชุงุฌุฑ',
                    description: 'ุงุญุตู ุนูู ูููุน ุงุณุชุซูุงุฑู ุฑุฆูุณู ููู ุจุจูุงุก ุฅูุจุฑุงุทูุฑูุชู ุงูุงูุชุตุงุฏูุฉ.',
                    image: 'https://i.postimg.cc/sgG0XH3n/2f00b6c45a507592e11a78723cded8167292bb85.png',
                    link: 'investment'
                },
                {
                    title: 'ุฑูุงุนู',
                    description: 'ุงุญุฌุฒ ููุงูู ูุฑุงุนู ุฑุฆูุณู. ุงุณุชูุชุน ุจูุฒุงูุง ุญุตุฑูุฉ ูุดูุฑุฉ ูุง ุญุฏูุฏ ููุง.',
                    image: 'https://i.postimg.cc/nr5GfZjN/1de6d9503b44e3004e668cb22dc99420bd561c10.jpg',
                    link: 'sponsors'
                },
                {
                    title: 'ุญูููุงุช ุดุงุญูุงุช',
                    description: 'ุดุงุญูุงุช ูููุฉ ููุชููุฉ ูููู ุงูุจุถุงุฆุน ูุงูุญูููุงุช ุงูุซูููุฉ ุจููุงุกุฉ ุนุงููุฉ.',
                    image: 'https://i.postimg.cc/rmf4xgMM/993cc445-2f0d-433e-84c9-a454bc30ca79-500x285.webp',
                    link: 'vehicles',
                    filter: 'ุดุงุญูุงุช'
                },
                {
                    title: 'ุฎุฏูุงุช ุงูุฃููุงู',
                    description: 'ุฏุนู ููุฏู ูุชุณูููุงุช ูุงููุฉ ูุจุฏุก ูุดุฑูุนู ุฃู ุชุนุฒูุฒ ุฑุตูุฏู ุจุณุฑุนุฉ ูุฃูุงู.',
                    image: 'https://i.postimg.cc/66Sr3Wqk/dc474574-0435-4156-b92a-1a1810f9c525-500x354-20315236427-g-VEtn-ONIK5-Vrb439x-OJPXpo-LIDLu7j-GJMU9o-BVVo.jpg',
                    link: 'money-services'
                },
                {
                    title: 'ุงูุจุงูุฏ ูุงูุณุฌู',
                    description: 'ุฎุฏูุงุช ุฅููุงุก ูุชุฎููู ุงูุนููุจุงุช ุฏุงุฎู ุงููุนุจุฉ ูุถูุงู ุงุณุชูุฑุงุฑูุฉ ูุนุจู.',
                    image: 'https://i.postimg.cc/L5zLwfSB/63d0fca7-18e7-4326-b1ba-695ea261c995-500x330.webp',
                    link: 'ban-jail'
                }
            ];

            // ุฎูุท ุงูุจุทุงูุงุช ุจุดูู ุนุดูุงุฆู
            const shuffledCards = shuffleArray(featuredCards);

            return `
                <!-- ูุณู ุงูุจุทู (Hero Section) -->
                <section id="hero-section" class="relative h-screen flex items-center justify-center overflow-hidden border-b border-cyan-500/50" data-property="{videoURL:'https://www.youtube.com/watch?v=KRMcfL4vBIQ',containment:'#hero-section',autoPlay:true,mute:true,startAt:0,opacity:1,showControls:false,loop:true}">
                    <div class="absolute inset-0 z-10 bg-gradient-to-br from-black/40 via-transparent to-black/40"></div>

                    <div class="relative z-20 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center py-32 sm:py-40">
                        <h1 class="text-6xl sm:text-7xl font-extrabold text-white mb-6 leading-tight">
                            ููุงุทุนุฉ ุจูุณู <span class="text-cyan-400">ุงุตูุน ูุงูุนู ุงูุฎุงุต</span>
                        </h1>
                        <p class="text-2xl text-gray-300 max-w-4xl mx-auto mb-10 font-light">
                            ูุชุฌุฑู ุงูุญุตุฑู ููุงุฑุชูุงุก ุจููุงูุชู ูู ุนุงูู FiveM. ุณูุงุก ููุช ุชุจุญุซ ุนู <span class="text-white font-semibold">ุณูุงุฑุงุช ูุงุฎุฑุฉ</span>ุ ูุฑุตุฉ <span class="text-white font-semibold">ุงุณุชุซูุงุฑ ูุชุฌุฑู ุงูุฎุงุต ูู ููุงุทุนุฉ</span>ุ ุฃู <span class="text-white font-semibold">ุฑุนุงูุฉ</span> ุชุซุจุช ูููุฐูุ ูุฅู ุฑูุงุนู ูู ููุทุฉ ุงูุจุฏุงูุฉ ููู ูุฌุงุญ ูู ููุงุทุนุฉ ุจูุณู.
                        </p>
                        <a href="#" onclick="navigateTo('vehicles')" class="btn-primary mt-10 inline-block" title="ุงูุชุดู ุงูููุชุฌุงุช">
                            ุงูุชุดู ูุฑุต ุจูุณู
                        </a>
                    </div>
                </section>

                <!-- ูุณู ุจุทุงูุงุช ุงููููุฒุงุช -->
                <section class="py-20 bg-[#0F0F0F] px-4 sm:px-6 lg:px-8">
                    <div class="max-w-7xl mx-auto">
                        <div class="text-center mb-12">
                            <h2 class="text-4xl font-extrabold text-white border-b border-cyan-600/50 pb-4 inline-block">
                                ุงุจุฑุฒ ููุชุฌุงุช ููุงุทุนุฉ ุจูุณู
                            </h2>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
                            ${shuffledCards.map(card => `
                                <a href="#" onclick="${card.filter ? `navigateTo('${card.link}', '${card.filter}')` : `navigateTo('${card.link}')`}" class="feature-card group">
                                    <div class="card-image-container">
                                        <img src="${card.image}" 
                                             alt="${card.title}" 
                                             class="card-image"
                                             onerror="this.onerror=null;this.src='https://placehold.co/600x320/101010/ffffff?text=Product'" />
                                    </div>
                                    <div class="p-6 text-center">
                                        <h3 class="text-2xl font-bold text-white mb-3">${card.title}</h3>
                                        <p class="text-gray-400 text-sm">${card.description}</p>
                                    </div>
                                </a>
                            `).join('')}
                        </div>
                    </div>
                </section>

                <!-- ูุณู ุฃุญุฏุซ ุงูููุชุฌุงุช -->
                <section id="featured-products-section" class="py-20 bg-[#0F0F0F] px-4 sm:px-6 lg:px-8 hidden">
                    <div class="max-w-7xl mx-auto">
                        <div class="text-center mb-16">
                            <div class="inline-block relative">
                                <h2 class="text-5xl md:text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 mb-4 animate-pulse">
                                    โจ ุฃุญุฏุซ ุงูููุชุฌุงุช โจ
                                </h2>
                                <div class="absolute -inset-1 bg-gradient-to-r from-cyan-500 to-purple-600 rounded-lg blur opacity-30 animate-pulse"></div>
                            </div>
                            <p class="text-gray-400 text-lg mt-4">ุงูุชุดู ุฃุญุฏุซ ุฅุถุงูุงุชูุง ุงูุญุตุฑูุฉ</p>
                        </div>
                        <div id="featured-product-container" class="relative">
                            <!-- ุณูุชู ุนุฑุถ ููุชุฌ ูุงุญุฏ ููุง -->
                        </div>
                    </div>
                </section>

                <!-- ูุณู ุชุณูููู ุฌุฏูุฏ -->
                <section class="py-24 bg-black">
                    <!-- ุงููุญุชูู -->
                    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                            <!-- ุงููุญุชูู ุงููุตู ุนูู ุงููููู -->
                            <div class="text-center md:text-right order-first md:order-last">
                                <h3 class="text-xl font-bold text-cyan-400 mb-2">ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู</h3>
                                <p class="text-2xl text-gray-300 max-w-xl mx-auto md:mx-0">
                                    ุฌููุน ุงููุนุงููุงุช ูุงูุชูุงุตู ุนุจุฑ ุฏูุณููุฑุฏ ุงูุณูุฑูุฑ ููุท.
                                </p>
                                <div class="mt-8">
                                    <a href="https://discord.com/channels/1420047523397111850/1420133467202654379/1422680937115684914" target="_blank" class="inline-flex items-center gap-3 bg-blue-600 hover:bg-blue-500 text-white font-bold py-5 px-16 rounded-xl text-3xl transition duration-300 transform hover:scale-105 shadow-xl shadow-blue-500/50">
                                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.317 4.36981C18.7915 3.08433 16.981 2.04883 15 1.41016V1.41016C15 1.41016 14.9459 1.35608 14.8918 1.35608C14.8376 1.35608 14.7835 1.41016 14.7835 1.41016C13.258 1.99475 11.8447 2.57935 10.5436 3.21802C8.90246 2.52527 7.14916 1.93054 5.28241 1.41016C5.22833 1.35608 5.17425 1.35608 5.12018 1.41016C4.95385 1.41016 4.8457 1.51831 4.79162 1.68054C3.03833 4.92004 2.4436 8.26764 3.19043 11.457C3.19043 11.457 3.19043 11.5111 3.24451 11.5652C3.29858 11.6192 3.35266 11.6192 3.35266 11.6192C4.43414 11.1529 5.46155 10.7407 6.43489 10.2744C6.48896 10.2203 6.48896 10.1662 6.43489 10.1122C6.01147 9.75398 5.64215 9.3418 5.3269 8.87556C5.27283 8.82148 5.16467 8.82148 5.1106 8.87556C5.05652 8.92964 5.05652 9.03779 5.1106 9.09187C5.58801 9.67646 6.11951 10.207 6.651 10.6732C6.70508 10.7273 6.75916 10.7273 6.81323 10.7273C10.1068 12.5378 13.8932 12.5378 17.1868 10.7273C17.2408 10.7273 17.2949 10.7273 17.349 10.6732C17.8805 10.207 18.412 9.67646 18.8894 9.09187C18.9435 9.03779 18.9435 8.92964 18.8894 8.87556C18.8353 8.82148 18.7272 8.82148 18.6731 8.87556C18.3579 9.3418 17.9885 9.75398 17.5651 10.1122C17.511 10.1662 17.511 10.2203 17.5651 10.2744C18.5384 10.7407 19.5659 11.1529 20.6473 11.6192C20.6473 11.6192 20.7014 11.6192 20.7555 11.5652C20.8096 11.5111 20.8096 11.457 20.8096 11.457C21.6646 7.94728 21.3494 4.92004 20.317 4.36981ZM8.02008 9.39587C7.32733 9.39587 6.78662 8.86536 6.78662 8.17261C6.78662 7.47986 7.32733 6.94934 8.02008 6.94934C8.71283 6.94934 9.25354 7.47986 9.25354 8.17261C9.25354 8.86536 8.71283 9.39587 8.02008 9.39587ZM15.9799 9.39587C15.2872 9.39587 14.7465 8.86536 14.7465 8.17261C14.7465 7.47986 15.2872 6.94934 15.9799 6.94934C16.6727 6.94934 17.2134 7.47986 17.2134 8.17261C17.2134 8.86536 16.6727 9.39587 15.9799 9.39587Z"></path></svg>
                                        <span>ุชูุงุตู ูุน ุฏุนู ุงูููู ุจูุณู</span>
                                    </a>
                                </div>
                            </div>
                            <!-- ุงูุตูุฑุฉ ุนูู ุงููุณุงุฑ -->
                            <div class="order-last md:order-first">
                                <img src="https://cdn.salla.sa/form-builder/ocFpbEq4F63eKoT69reT8dNhlivKaddVZK8cPI61.jpg" alt="FiveM Store" class="w-full h-auto rounded-2xl shadow-2xl shadow-cyan-500/20">
                            </div>
                        </div>
                    </div>
                </section>
            `;
        }

        // 2. ุนุฑุถ ุตูุญุฉ ูุฑูุจุงุช ุจูุณู (ูุน ุงูููุงุชุฑ ูุงูููุชุฌุงุช)
        function renderVehiclesPage() {
            // ุชุฌููุน ุฎูุงุฑุงุช ุงูููุชุฑ ุงููุชุงุญุฉ ูู ุงูุจูุงูุงุช
            const allTypes = [...new Set(allProducts.vehicles.map(v => v.type))];
            const allRarities = [...new Set(allProducts.vehicles.map(v => v.rarity))];

            return `
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                    <h2 class="text-5xl font-extrabold text-white mb-10 text-center md:text-right">
                        ูุฑูุจุงุช ุจูุณู ุงููุชุงุญุฉ
                        <p class="text-base font-light text-cyan-400 mt-2">ูุฑูุจุงุช ุญุตุฑูุฉ ููุณุชููุงุช ุงููููุฐ ุงูุนุงูู.</p>
                    </h2>
                    
                    <!-- ุชุฎุทูุท ุงูุดุจูุฉ (ุดุฑูุท ุฌุงูุจู + ููุชุฌุงุช) -->
                    <div class="flex flex-col lg:flex-row gap-8">
                        
                        <!-- ุงูุดุฑูุท ุงูุฌุงูุจู (Filters) -->
                        <aside class="w-full lg:w-1/4 bg-gray-900 p-4 lg:p-6 rounded-xl shadow-lg border border-gray-800 h-fit lg:sticky top-28">
                            <div class="flex justify-between items-center cursor-pointer lg:cursor-default" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
                                <h3 class="text-xl font-bold text-white">ุงูููุงุชุฑ</h3>
                                <svg class="w-6 h-6 text-white lg:hidden transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                            <div class="hidden lg:block mt-4 pt-4 lg:pt-2 border-t border-gray-700 lg:border-none space-y-6">
                            <!-- ุญูู ุงูุจุญุซ -->
                            <div>
                                <label class="block text-gray-400 font-semibold mb-2">ุจุญุซ ุจุงูุงุณู</label>
                                <div class="relative">
                                    <input type="text" id="search-vehicles" placeholder="ุงุณู ุงููุฑูุจุฉ..." oninput="filterItems('vehicles')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-3 pr-10 focus:ring-cyan-500 focus:border-cyan-500">
                                    <svg class="w-5 h-5 text-gray-400 absolute right-3 top-1/2 transform -translate-y-1/2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                                </div>
                            </div>
                            
                            <!-- ููุงุชุฑ ุงููุฆุฉ -->
                            <div>
                                <label class="block text-gray-400 font-semibold mb-2">ุงููุฆุฉ</label>
                                <div class="space-y-2">
                                    <button onclick="filterItems('vehicles', 'all')" class="category-filter-btn active w-full bg-cyan-500 text-gray-900 font-bold py-2 px-4 rounded-lg transition">ุงููู</button>
                                    <button onclick="filterItems('vehicles', 'ููุงุทููู')" class="category-filter-btn w-full bg-gray-800 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition">ูุฑูุจุงุช ููุงุทููู</button>
                                    <button onclick="filterItems('vehicles', 'ุญููููุฉ')" class="category-filter-btn w-full bg-gray-800 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition">ูุฑูุจุงุช ุญููููุฉ</button>
                                    <button onclick="filterItems('vehicles', 'ุดุงุญูุงุช')" class="category-filter-btn w-full bg-gray-800 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition">ุดุงุญูุงุช ูุญูููุงุช</button>
                                </div>
                            </div>
                            
                            <!-- ููุชุฑ ุงูุณุนุฑ -->
                            <div>
                                <label id="price-filter-label" class="block text-gray-400 font-semibold mb-2">ูุทุงู ุงูุณุนุฑ</label>
                                <div class="flex items-center gap-2">
                                    <input type="number" id="filter-price-min" placeholder="ูู" oninput="filterItems('vehicles')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500" min="0">
                                    <span class="text-gray-500">-</span>
                                    <input type="number" id="filter-price-max" placeholder="ุฅูู" oninput="filterItems('vehicles')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500" min="0">
                                </div>
                            </div>

                            <button onclick="clearFilters('vehicles')" class="w-full bg-red-600 hover:bg-red-500 text-white font-bold py-2 rounded-lg transition">
                                ูุณุญ ุงูููุงุชุฑ
                            </button>
                            </div>
                        </aside>

                        <!-- ููุทูุฉ ุนุฑุถ ุงูููุชุฌุงุช ุงูุฑุฆูุณูุฉ -->
                        <div class="w-full lg:w-3/4">
                            <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                                <!-- ุณูุชู ููุก ูุฐุง ุจูุงุณุทุฉ JavaScript -->
                            </div>
                            <div id="no-results-message" class="text-center text-gray-400 text-2xl mt-16 hidden">
                                ๐ง ูุง ุชูุฌุฏ ูุฑูุจุงุช ุชุทุงุจู ุดุฑูุท ุงูููุชุฑ ุงููุญุฏุฏุฉ.
                            </div>
                        </div>

                    </div>
                </div>
            `;
        }

        // 3. ุนุฑุถ ุตูุญุฉ ูุฑุต ุงูุงุณุชุซูุงุฑ
        function renderInvestmentPage() {
            const allTypes = [...new Set(allProducts.investments.map(v => v.type))];
            const allRegions = [...new Set(allProducts.investments.map(v => v.region))];

            return `
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                    <h2 class="text-5xl font-extrabold text-white mb-10 text-center md:text-right">
                        ูุฑุต ุงูุงุณุชุซูุงุฑ ุงููุชุงุญุฉ
                        <p class="text-base font-light text-cyan-400 mt-2">ุนูุงุฑุงุช ููุดุงุฑูุน ุญุตุฑูุฉ ูุจูุงุก ุฅูุจุฑุงุทูุฑูุชู.</p>
                    </h2>

                    <!-- ููุงุชุฑ ุงููุฆุฉ ุงูุฌุฏูุฏุฉ ููุงุณุชุซูุงุฑ -->
                    <div id="category-filters" class="flex flex-wrap justify-center gap-4 mb-10">
                        <button onclick="filterItems('investments', 'all')" class="category-filter-btn active bg-cyan-500 text-gray-900 font-bold py-3 px-6 rounded-full transition duration-200 text-lg">ุงููู</button>
                        <button onclick="filterItems('investments', 'ุงูุจูุงูุงุช')" class="category-filter-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-full transition duration-200 text-lg">ุงูุจูุงูุงุช</button>
                        <button onclick="filterItems('investments', 'ูุญุทุงุช ุงููููุฏ')" class="category-filter-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-full transition duration-200 text-lg">ูุญุทุงุช ุงููููุฏ</button>
                        <button onclick="filterItems('investments', 'ุงูุตูุฏููุงุช')" class="category-filter-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-full transition duration-200 text-lg">ุงูุตูุฏููุงุช</button>
                        <button onclick="filterItems('investments', 'ูุญู ุงูุงุณูุญุฉ')" class="category-filter-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-full transition duration-200 text-lg">ูุญู ุงูุงุณูุญุฉ</button>
                        <button onclick="filterItems('investments', 'ูุฑุด ุงูุชุฒููุฏ')" class="category-filter-btn bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-full transition duration-200 text-lg">ูุฑุด ุงูุชุฒููุฏ</button>
                    </div>
                    
                    <!-- ููุงุชุฑ ุงูููุงุทู -->
                    <div id="region-filters" class="flex flex-wrap justify-center gap-3 mb-10">
                        <button onclick="filterByRegion('all')" class="region-filter-btn active bg-purple-500 text-white font-bold py-2 px-5 rounded-full transition duration-200 text-sm">ูู ุงูููุงุทู</button>
                        <button onclick="filterByRegion('ููุณ')" class="region-filter-btn bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-5 rounded-full transition duration-200 text-sm">ููุณ</button>
                        <button onclick="filterByRegion('ุณุงูุฏู')" class="region-filter-btn bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-5 rounded-full transition duration-200 text-sm">ุณุงูุฏู</button>
                        <button onclick="filterByRegion('ุจูููุชู')" class="region-filter-btn bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-5 rounded-full transition duration-200 text-sm">ุจูููุชู</button>
                        <button onclick="filterByRegion('ุฌุฒูุฑุฉ ุจูููุชู')" class="region-filter-btn bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-5 rounded-full transition duration-200 text-sm">ุฌุฒูุฑุฉ ุจูููุชู</button>
                        <button onclick="filterByRegion('ุฌุฒูุฑุฉ ูุฑุณุงู')" class="region-filter-btn bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-5 rounded-full transition duration-200 text-sm">ุฌุฒูุฑุฉ ูุฑุณุงู</button>
                    </div>
                    
                    <!-- ุชุฎุทูุท ุงูุดุจูุฉ (ุดุฑูุท ุฌุงูุจู + ูุญุชูู) -->
                    <div class="flex flex-col lg:flex-row gap-8">
                        
                        <!-- ุงูุดุฑูุท ุงูุฌุงูุจู (Filters) -->
                        <aside class="w-full lg:w-1/4 bg-gray-900 p-4 lg:p-6 rounded-xl shadow-lg border border-gray-800 h-fit lg:sticky top-28">
                            <div class="flex justify-between items-center cursor-pointer lg:cursor-default" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
                                <h3 class="text-xl font-bold text-white">ุงูููุงุชุฑ ุงููุชูุฏูุฉ</h3>
                                <svg class="w-6 h-6 text-white lg:hidden transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                            <div class="hidden lg:block mt-4 pt-4 lg:pt-2 border-t border-gray-700 lg:border-none">
                            <div class="mb-6">
                                <label id="price-filter-label" class="block text-gray-400 font-semibold mb-2">ูุทุงู ุงูุณุนุฑ (ุจุงูุฏููุงุฑ)</label>
                                <div class="flex items-center gap-2">
                                    <input type="number" id="filter-price-min" placeholder="ุฃูู ุณุนุฑ" oninput="filterItems('investments')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500 placeholder:text-gray-500" min="0">
                                    <span class="text-gray-500">-</span>
                                    <input type="number" id="filter-price-max" placeholder="ุฃุนูู ุณุนุฑ" oninput="filterItems('investments')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500 placeholder:text-gray-500" min="0">
                                </div>
                            </div>
                            <button onclick="clearFilters('investments')" class="w-full bg-red-600 hover:bg-red-500 text-white font-bold py-2 rounded-lg transition duration-150">
                                ูุณุญ ุงูููุงุชุฑ
                            </button>
                            </div>
                        </aside>

                        <!-- ููุทูุฉ ุนุฑุถ ุงููุญุชูู ุงูุฑุฆูุณูุฉ -->
                        <div class="w-full lg:w-3/4">
                            <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
                            <div id="no-results-message" class="text-center text-gray-400 text-2xl mt-16 hidden">
                                ๐ง ูุง ุชูุฌุฏ ูุฑุต ุชุทุงุจู ุดุฑูุท ุงูููุชุฑ ุงููุญุฏุฏุฉ.
                            </div>
                        </div>

                    </div>
                </div>
            `;
        }

        // 4. ุนุฑุถ ุตูุญุฉ ุฑูุงุนู ุจูุณู
        function renderSponsorsPage() {
            return `
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                    <h2 class="text-5xl font-extrabold text-white mb-10 text-center md:text-right">
                        ุจุฑูุงูุฌ ุฑูุงุนู ุจูุณู
                        <p class="text-base font-light text-cyan-400 mt-2">ุงูุถู ุฅูู ูุจุงุฑ ุงูุฑุนุงุฉ ูุนุฒุฒ ูููุฐู ุงูุฅุนูุงูู ูุงูุงุฌุชูุงุนู.</p>
                    </h2>
                    
                    <!-- ุชุฎุทูุท ุงูุดุจูุฉ (ุดุฑูุท ุฌุงูุจู + ูุญุชูู) -->
                    <div class="flex flex-col lg:flex-row gap-8">
                        
                        <!-- ุงูุดุฑูุท ุงูุฌุงูุจู (Filters) -->
                        <aside class="w-full lg:w-1/4 bg-gray-900 p-4 lg:p-6 rounded-xl shadow-lg border border-gray-800 h-fit lg:sticky top-28">
                            <div class="flex justify-between items-center cursor-pointer lg:cursor-default" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
                                <h3 class="text-xl font-bold text-white">ุชุตููู ุงูุจุงูุงุช</h3>
                                <svg class="w-6 h-6 text-white lg:hidden transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                            <div class="hidden lg:block mt-4 pt-4 lg:pt-2 border-t border-gray-700 lg:border-none">
                            <div class="mb-6">
                                <label id="price-filter-label" class="block text-gray-400 font-semibold mb-2">ูุทุงู ุงูุณุนุฑ (ุจุงูุฏููุงุฑ)</label>
                                <div class="flex items-center gap-2">
                                    <input type="number" id="filter-price-min" placeholder="ุฃูู ุณุนุฑ" oninput="filterItems('sponsors')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500 placeholder:text-gray-500" min="0">
                                    <span class="text-gray-500">-</span>
                                    <input type="number" id="filter-price-max" placeholder="ุฃุนูู ุณุนุฑ" oninput="filterItems('sponsors')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500 placeholder:text-gray-500" min="0">
                                </div>
                            </div>
                            <button onclick="clearFilters('sponsors')" class="w-full bg-red-600 hover:bg-red-500 text-white font-bold py-2 rounded-lg transition duration-150">
                                ูุณุญ ุงูููุงุชุฑ
                            </button>
                            </div>
                        </aside>

                        <!-- ููุทูุฉ ุนุฑุถ ุงููุญุชูู ุงูุฑุฆูุณูุฉ -->
                        <div class="w-full lg:w-3/4">
                            <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
                            <div id="no-results-message" class="text-center text-gray-400 text-2xl mt-16 hidden">
                                ๐ง ูุง ุชูุฌุฏ ุจุงูุงุช ุชุทุงุจู ุดุฑูุท ุงูููุชุฑ ุงููุญุฏุฏุฉ.
                            </div>
                        </div>

                    </div>
                </div>
            `;
        }

        // 5. ุนุฑุถ ุตูุญุฉ ุฎุฏูุงุช ุงูุฃููุงู
        function renderMoneyServicesPage() {
            return `
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                    <h2 class="text-5xl font-extrabold text-white mb-10 text-center md:text-right">ุฎุฏูุงุช ุงูุฃููุงู</h2>
                    <div class="flex flex-col lg:flex-row gap-8">
                        <aside class="w-full lg:w-1/4 bg-gray-900 p-4 lg:p-6 rounded-xl shadow-lg border border-gray-800 h-fit lg:sticky top-28">
                            <div class="flex justify-between items-center cursor-pointer lg:cursor-default" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
                                <h3 class="text-xl font-bold text-white">ุชุตููู ุงูุฎุฏูุงุช</h3>
                                <svg class="w-6 h-6 text-white lg:hidden transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                            <div class="hidden lg:block mt-4 pt-4 lg:pt-2 border-t border-gray-700 lg:border-none">
                            <div class="mb-6">
                                <label id="price-filter-label" class="block text-gray-400 font-semibold mb-2">ูุทุงู ุงูุณุนุฑ (ุจุงูุฏููุงุฑ)</label>
                                <div class="flex items-center gap-2">
                                    <input type="number" id="filter-price-min" placeholder="ุฃูู ุณุนุฑ" oninput="filterItems('moneyServices')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500 placeholder:text-gray-500" min="0">
                                    <span class="text-gray-500">-</span>
                                    <input type="number" id="filter-price-max" placeholder="ุฃุนูู ุณุนุฑ" oninput="filterItems('moneyServices')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500 placeholder:text-gray-500" min="0">
                                </div>
                            </div>
                            <button onclick="clearFilters('moneyServices')" class="w-full bg-red-600 hover:bg-red-500 text-white font-bold py-2 rounded-lg">ูุณุญ ุงูููุงุชุฑ</button>
                            </div>
                        </aside>
                        <div class="w-full lg:w-3/4">
                            <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
                            <div id="no-results-message" class="text-center text-gray-400 text-2xl mt-16 hidden">
                                ๐ง ูุง ุชูุฌุฏ ุฎุฏูุงุช ุชุทุงุจู ุดุฑูุท ุงูููุชุฑ ุงููุญุฏุฏุฉ.
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 6. ุนุฑุถ ุตูุญุฉ ุงูุจุงูุฏ ูุงูุณุฌู
        function renderBanJailPage() {
            return `
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                    <h2 class="text-5xl font-extrabold text-white mb-10 text-center md:text-right">ุงูุจุงูุฏ ูุงูุณุฌู</h2>
                    <div class="flex flex-col lg:flex-row gap-8">
                        <aside class="w-full lg:w-1/4 bg-gray-900 p-4 lg:p-6 rounded-xl shadow-lg border border-gray-800 h-fit lg:sticky top-28">
                            <div class="flex justify-between items-center cursor-pointer lg:cursor-default" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('svg').classList.toggle('rotate-180')">
                                <h3 class="text-xl font-bold text-white">ุชุตููู ุงูุฎุฏูุงุช</h3>
                                <svg class="w-6 h-6 text-white lg:hidden transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                            <div class="hidden lg:block mt-4 pt-4 lg:pt-2 border-t border-gray-700 lg:border-none">
                            <div class="mb-6">
                                <label id="price-filter-label" class="block text-gray-400 font-semibold mb-2">ูุทุงู ุงูุณุนุฑ (ุจุงูุฏููุงุฑ)</label>
                                <div class="flex items-center gap-2">
                                    <input type="number" id="filter-price-min" placeholder="ุฃูู ุณุนุฑ" oninput="filterItems('banJail')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500 placeholder:text-gray-500" min="0">
                                    <span class="text-gray-500">-</span>
                                    <input type="number" id="filter-price-max" placeholder="ุฃุนูู ุณุนุฑ" oninput="filterItems('banJail')" class="w-full bg-gray-800 text-white border border-gray-700 rounded-lg p-2 text-sm focus:ring-cyan-500 focus:border-cyan-500 placeholder:text-gray-500" min="0">
                                </div>
                            </div>
                            <button onclick="clearFilters('banJail')" class="w-full bg-red-600 hover:bg-red-500 text-white font-bold py-2 rounded-lg">ูุณุญ ุงูููุงุชุฑ</button>
                            </div>
                        </aside>
                        <div class="w-full lg:w-3/4">
                            <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"></div>
                            <div id="no-results-message" class="text-center text-gray-400 text-2xl mt-16 hidden">
                                ๐ง ูุง ุชูุฌุฏ ุฎุฏูุงุช ุชุทุงุจู ุดุฑูุท ุงูููุชุฑ ุงููุญุฏุฏุฉ.
                            </div>
                        </div>

                    </div>
                </div>
            `;
        }



        // === ูุธุงู ุงูุชุฃุฌูุฑ ูุงูุนุฏุงุฏ ุงูุชูุงุฒูู ===
        
        function calculateRentalCountdown(rentalStartDate, rentalDurationDays) {
            if (!rentalStartDate || !rentalDurationDays) return null;
            
            const start = new Date(rentalStartDate);
            const end = new Date(start.getTime() + rentalDurationDays * 24 * 60 * 60 * 1000);
            const now = new Date();
            const remaining = end - now;
            
            if (remaining <= 0) return { expired: true, days: 0, hours: 0, minutes: 0 };
            
            const days = Math.floor(remaining / (1000 * 60 * 60 * 24));
            const hours = Math.floor((remaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
            
            return { expired: false, days, hours, minutes, isExpiringSoon: days <= 3 };
        }
        
        function renderRentalCountdown(product) {
            const countdown = calculateRentalCountdown(product.rental_start_date, product.rental_duration_days);
            if (!countdown) return '';
            
            if (countdown.expired) return '';
            
            const colorClass = countdown.isExpiringSoon ? 'bg-red-600 border-red-500' : 'bg-orange-600 border-orange-500';
            const icon = countdown.isExpiringSoon ? 'โ๏ธ' : 'โฐ';
            
            return `
                <div class="${colorClass} border-2 px-3 py-2 rounded-lg text-white text-sm font-bold animate-pulse">
                    ${icon} ูุชุจูู: ${countdown.days} ููู ู ${countdown.hours} ุณุงุนุฉ
                </div>
            `;
        }
        
        async function checkExpiredRentals() {
            try {
                const allData = await supabaseAPI.getAllData();
                let hasChanges = false;
                
                for (const product of allData.investments) {
                    if (product.rental_start_date && product.rental_duration_days) {
                        const countdown = calculateRentalCountdown(product.rental_start_date, product.rental_duration_days);
                        if (countdown && countdown.expired && product.status === 'ูุคุฌุฑ') {
                            product.status = 'ูุชููุฑ';
                            product.rental_start_date = null;
                            product.rental_duration_days = null;
                            hasChanges = true;
                            
                            await supabaseAPI.updateProduct('investments', product.id, {
                                status: 'ูุชููุฑ',
                                rental_start_date: null,
                                rental_duration_days: null
                            });
                        }
                    }
                }
                
                if (hasChanges) {
                    console.log('โ ุชู ุชุญุฏูุซ ุงูููุชุฌุงุช ุงูููุชููุฉ ุชููุงุฆูุงู');
                    allProducts = await supabaseAPI.getAllData();
                }
            } catch (error) {
                console.error('ุฎุทุฃ ูู ูุญุต ุงูุชุฃุฌูุฑุงุช ุงูููุชููุฉ:', error);
            }
        }
        
        setInterval(checkExpiredRentals, 60000);

        // === ูุธุงุฆู ูุณุงุนุฏุฉ (Helpers) ===

        function formatPrice(basePriceString) {
            const { price, currency } = basePriceString;
            const numericPrice = parseFloat(price);
            if (isNaN(numericPrice) || !currency) return 'N/A';

            let displayPrice = numericPrice;
            let originalDisplayPrice = null;

            if (appState.sale.isActive && appState.sale.percentage > 0) {
                originalDisplayPrice = numericPrice;
                displayPrice = numericPrice * (1 - appState.sale.percentage / 100);
            }

            const formatValue = (value, targetCurrency) => {
                const symbols = {
                    'USD': '$', 'SAR': 'ุฑูุงู', 'AED': 'ุฏ.ุฅ',
                    'KWD': 'ุฏ.ู', 'BHD': 'ุฏ.ุจ', 'OMR': 'ุฑ.ุน',
                    'QAR': 'ุฑ.ู', 'IQD': 'ุฏ.ุน', 'JOD': 'ุฏ.ุฃ'
                };
                const formatted = value.toLocaleString('ar-SA', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
                return targetCurrency === 'USD' ? `${formatted}$` : `${formatted} ${symbols[targetCurrency]}`;
            };

            const displayCurrency = appState.currentCurrency;

            if (displayCurrency !== currency) {
                const priceInUSD = numericPrice / appState.conversionRates[currency];
                displayPrice = priceInUSD * appState.conversionRates[displayCurrency];
                if (originalDisplayPrice !== null) {
                    originalDisplayPrice = (originalDisplayPrice / appState.conversionRates[currency]) * appState.conversionRates[displayCurrency];
                }
            }

            if (originalDisplayPrice !== null) {
                return `
                    <span class="text-sm text-gray-500 line-through">${formatValue(originalDisplayPrice, displayCurrency)}</span>
                    <span class="text-white">${formatValue(displayPrice, displayCurrency)}</span>
                `;
            }

            return `<span class="text-white">${formatValue(displayPrice, displayCurrency)}</span>`;
        }
        
        function formatSimplePrice(price, currency) {
            let displayPrice = price;
            const displayCurrency = appState.currentCurrency;

            if (displayCurrency !== currency) {
                const priceInUSD = price / appState.conversionRates[currency];
                displayPrice = priceInUSD * appState.conversionRates[displayCurrency];
            }
            
            const symbols = {
                'USD': '$', 'SAR': 'ุฑูุงู', 'AED': 'ุฏ.ุฅ',
                'KWD': 'ุฏ.ู', 'BHD': 'ุฏ.ุจ', 'OMR': 'ุฑ.ุน',
                'QAR': 'ุฑ.ู', 'IQD': 'ุฏ.ุน', 'JOD': 'ุฏ.ุฃ'
            };
            const formatted = displayPrice.toLocaleString('ar-SA', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            return displayCurrency === 'USD' ? `${formatted}$` : `${formatted} ${symbols[displayCurrency]}`;
        }

        // ูุธููุฉ ูุฑุณู ุงููุฌูู
        function renderStars(rating) {
            let starsHtml = '';
            const fullStars = Math.floor(rating);
            const halfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);

            for (let i = 0; i < fullStars; i++) {
                starsHtml += '<svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>';
            }
            if (halfStar) {
                starsHtml += '<svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8-2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292zM10 12.535V4.465l.535 1.645a1 1 0 00.95.69h1.732l-1.4 1.018a1 1 0 00-.364 1.118l.535 1.645-1.4-1.018a1 1 0 00-1.175 0z"></path></svg>';
            }
            for (let i = 0; i < emptyStars; i++) {
                starsHtml += '<svg class="w-4 h-4 text-gray-600" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>';
            }
            return starsHtml;
        }

        // ูุชุบูุฑุงุช ุนุฑุถ ุฃุญุฏุซ ุงูููุชุฌุงุช
        let featuredProductsData = [];
        let currentFeaturedIndex = 0;
        let featuredInterval = null;

        // ุฏุงูุฉ ุนุฑุถ ุฃุญุฏุซ ุงูููุชุฌุงุช
        function renderFeaturedProducts() {
            const featuredProducts = allProducts.featuredProducts;
            const section = document.getElementById('featured-products-section');
            
            if (!featuredProducts || !featuredProducts.isActive || featuredProducts.products.length === 0) {
                section.classList.add('hidden');
                if (featuredInterval) {
                    clearInterval(featuredInterval);
                    featuredInterval = null;
                }
                return;
            }
            
            // ูุญุต ุชุงุฑูุฎ ุจุฏุงูุฉ ูููุงูุฉ ุงูุนุฑุถ
            const now = new Date();
            if (featuredProducts.startDate && now < new Date(featuredProducts.startDate)) {
                section.classList.add('hidden');
                return;
            }
            if (featuredProducts.endDate && now > new Date(featuredProducts.endDate)) {
                section.classList.add('hidden');
                return;
            }
            
            // ุชุญุถูุฑ ุจูุงูุงุช ุงูููุชุฌุงุช
            featuredProductsData = [];
            featuredProducts.products.forEach(fp => {
                const product = allProducts[fp.category]?.find(p => p.id === fp.id);
                if (product) {
                    featuredProductsData.push({ ...product, category: fp.category });
                }
            });
            
            if (featuredProductsData.length === 0) {
                section.classList.add('hidden');
                return;
            }
            
            section.classList.remove('hidden');
            currentFeaturedIndex = 0;
            displayCurrentFeaturedProduct();
        }
        
        // ุฏุงูุฉ ุนุฑุถ ุงูููุชุฌ ุงูุญุงูู
        function displayCurrentFeaturedProduct() {
            const container = document.getElementById('featured-product-container');
            const product = featuredProductsData[currentFeaturedIndex];
            
            if (!product) {
                return;
            }
            
            const images = product.image_urls || product.imageUrls || (product.image_url || product.imageUrl ? [product.image_url || product.imageUrl] : []);
            const mainImage = images[0] || 'https://placehold.co/600x400/101010/ffffff?text=' + product.name.replace(/\s/g, '+');
            const youtubeUrl = product.youtube_url || product.youtubeUrl || null;
            const videoId = youtubeUrl ? extractYoutubeId(youtubeUrl) : null;
            
            let stockInfo, actionButton;
            const productStatus = product.status || 'ูุชููุฑ';
            
            if (productStatus === 'ูุจุงุน') {
                stockInfo = `<div class="flex items-center gap-2 text-red-400"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg><span class="font-bold">๐ด ูุจุงุน</span></div>`;
                actionButton = `<button disabled class="bg-red-700 text-white font-bold py-4 px-10 rounded-xl cursor-not-allowed text-xl opacity-75">ูุจุงุน</button>`;
            } else if (productStatus === 'ุบูุฑ ูุชููุฑ') {
                stockInfo = `<div class="flex items-center gap-2 text-gray-400"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg><span class="font-bold">โซ ุบูุฑ ูุชููุฑ</span></div>`;
                actionButton = `<button disabled class="bg-gray-700 text-gray-500 font-bold py-4 px-10 rounded-xl cursor-not-allowed text-xl opacity-50">ุบูุฑ ูุชููุฑ</button>`;
            } else if (product.stock > 0) {
                stockInfo = `<div class="flex items-center gap-2 text-green-400"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg><span class="font-semibold">โ ูุชููุฑ: ${product.stock} ูุทุนุฉ</span></div>`;
                actionButton = `<button onclick="addToCart(${product.id}, '${product.category}')" class="group relative bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-white font-bold py-4 px-10 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-2xl hover:shadow-cyan-500/50 text-xl">
                    <span class="relative z-10 flex items-center gap-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                        ุฃุถู ููุณูุฉ ุงูุขู
                    </span>
                    <div class="absolute inset-0 bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </button>`;
            } else {
                stockInfo = `<div class="flex items-center gap-2 text-red-400"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg><span class="font-bold">ุบูุฑ ูุชููุฑ ุญุงููุงู</span></div>`;
                actionButton = `<button disabled class="bg-gray-700 text-gray-500 font-bold py-4 px-10 rounded-xl cursor-not-allowed text-xl opacity-50">ุบูุฑ ูุชููุฑ ุงูุขู</button>`;
            }
            
            // ุจุฏุก ุงูุชุจุฏูู ุงูุชููุงุฆู ุจูู ุงูุตูุฑุฉ ูุงูููุฏูู
            if (videoId) {
                setTimeout(() => {
                    const img = document.getElementById(`featured-img-${product.id}`);
                    const video = document.getElementById(`featured-video-${product.id}`);
                    if (img && video) {
                        img.classList.add('opacity-0');
                        video.classList.remove('opacity-0');
                        video.src = video.src.replace('autoplay=0', 'autoplay=1');
                    }
                }, 5000);
            }
            
            // ุงูุงูุชูุงู ููููุชุฌ ุงูุชุงูู ุจุนุฏ 40 ุซุงููุฉ
            if (featuredProductsData.length > 1) {
                setTimeout(() => {
                    currentFeaturedIndex = (currentFeaturedIndex + 1) % featuredProductsData.length;
                    displayCurrentFeaturedProduct();
                }, 40000);
            }
            
            container.innerHTML = `
                <div class="relative bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-3xl overflow-hidden shadow-2xl border border-cyan-500/30 hover:border-cyan-500/60 transition-all duration-500 group">
                    <!-- ุฎูููุฉ ูุชุญุฑูุฉ -->
                    <div class="absolute inset-0 bg-gradient-to-r from-cyan-500/10 via-blue-500/10 to-purple-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                    
                    <!-- ุดุงุฑุฉ NEW -->
                    <div class="absolute top-6 right-6 z-20">
                        <div class="bg-gradient-to-r from-red-500 to-pink-600 text-white px-4 py-2 rounded-full text-sm font-black shadow-lg animate-bounce">
                            ๐ฅ ุฌุฏูุฏ
                        </div>
                    </div>
                    
                    <!-- ูุคุดุฑุงุช ุงูุชููู ุจูู ุงูููุชุฌุงุช -->
                    ${featuredProductsData.length > 1 ? `
                    <div class="absolute bottom-6 left-1/2 transform -translate-x-1/2 z-20 flex gap-2">
                        ${featuredProductsData.map((_, idx) => `
                            <div class="w-3 h-3 rounded-full ${idx === currentFeaturedIndex ? 'bg-cyan-500 w-8' : 'bg-gray-600'} transition-all duration-300"></div>
                        `).join('')}
                    </div>` : ''}
                    
                    <div class="relative z-10 grid md:grid-cols-5 gap-10 p-10 md:p-16">
                        <!-- ูุณู ุงูุตูุฑุฉ ูุงูููุฏูู -->
                        <div class="relative group/img md:col-span-3" id="featured-media-${product.id}">
                            <div class="absolute inset-0 bg-gradient-to-br from-cyan-500/20 to-purple-500/20 rounded-3xl blur-2xl group-hover/img:blur-3xl transition-all duration-500"></div>
                            <div class="relative overflow-hidden rounded-3xl border-4 border-cyan-500/50 shadow-2xl">
                                <img id="featured-img-${product.id}" src="${mainImage}" alt="${product.name}" class="w-full h-[500px] md:h-[600px] object-cover transition-opacity duration-500" onerror="this.src='https://placehold.co/1200x800/101010/ffffff?text=${product.name.replace(/\s/g, '+')}'"/>
                                ${videoId ? `<iframe id="featured-video-${product.id}" class="w-full h-[500px] md:h-[600px] absolute inset-0 opacity-0 transition-opacity duration-500" src="https://www.youtube.com/embed/${videoId}?autoplay=0&mute=1&controls=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>` : ''}
                                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent pointer-events-none"></div>
                            </div>
                            ${images.length > 1 || videoId ? `<div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2 z-10">
                                ${images.slice(0, 4).map((img, idx) => `
                                    <div class="w-12 h-12 rounded-lg overflow-hidden border-2 border-white/30 hover:border-cyan-500 transition-all cursor-pointer">
                                        <img src="${img}" class="w-full h-full object-cover" />
                                    </div>
                                `).join('')}
                                ${videoId ? `<div class="w-12 h-12 rounded-lg overflow-hidden border-2 border-white/30 hover:border-cyan-500 transition-all cursor-pointer bg-red-600 flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"></path></svg></div>` : ''}
                            </div>` : ''}
                        </div>
                        
                        <!-- ูุณู ุงููุนูููุงุช -->
                        <div class="flex flex-col justify-center space-y-8 md:col-span-2">
                            <div>
                                <p class="text-cyan-400 text-sm font-bold uppercase tracking-wider mb-2">${getPageTitle(product.category)}</p>
                                <h3 class="text-5xl md:text-6xl font-black text-white mb-6 leading-tight">${product.name}</h3>
                                ${product.description ? `<p class="text-gray-400 text-base leading-relaxed line-clamp-3">${product.description}</p>` : ''}
                            </div>
                            
                            <div class="flex items-end gap-4">
                                <div>
                                    <p class="text-gray-500 text-sm mb-1">ุงูุณุนุฑ</p>
                                    <p class="text-6xl md:text-7xl font-black bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent">${formatPrice({price: product.price, currency: product.currency})}</p>
                                </div>
                            </div>
                            
                            ${stockInfo}
                            
                            <div class="pt-4">
                                ${actionButton}
                            </div>
                            
                            <!-- ูุนูููุงุช ุฅุถุงููุฉ -->
                            <div class="flex gap-6 pt-4 border-t border-gray-700">
                                <div class="flex items-center gap-2 text-gray-400">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"></path></svg>
                                    <span class="text-sm">ููุชุฌ ุญุตุฑู</span>
                                </div>
                                <div class="flex items-center gap-2 text-gray-400">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                                    <span class="text-sm">ุฌูุฏุฉ ูุถูููุฉ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ูุธููุฉ ูุนุฑุถ ุตูุญุฉ ุงูุตูุงูุฉ
        function renderMaintenancePage(message) {
            document.body.innerHTML = `
                <div id="maintenance-page" class="min-h-screen flex flex-col items-center justify-center text-center p-4">
                    <svg class="w-24 h-24 text-cyan-500 mb-6 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <h1 class="text-5xl font-extrabold text-white mb-4">ุงููุชุฌุฑ ุชุญุช ุงูุตูุงูุฉ</h1>
                    <p class="text-xl text-gray-300 max-w-2xl">
                        ${message || 'ูุญู ูููู ุจุจุนุถ ุงูุชุญุณููุงุช ุญุงููุงู. ุณูุนูุฏ ูุฑูุจุงู!'}
                    </p>
                </div>
            `;
        }

        // === ุฏูุงู ูุณุงุนุฏุฉ ===
        function getPageTitle(pageKey) {
            const titles = {
                vehicles: 'ูุฑูุจุงุช ุจูุณู',
                investments: 'ูุฑุต ุงูุงุณุชุซูุงุฑ',
                sponsors: 'ุฑูุงุนู ุจูุณู',
                moneyServices: 'ุฎุฏูุงุช ุงูุฃููุงู',
                banJail: 'ุงูุจุงูุฏ ูุงูุณุฌู'
            };
            return titles[pageKey] || pageKey;
        }

        // === ูุธุงุฆู ุงูุชุญูู ุงูุนุงูุฉ ุจุงูููุชุฌุงุช ูุงูููุงุชุฑ ===
        
        // ุฏุงูุฉ ูุฅูุดุงุก ุนุงุฑุถ ุงูุตูุฑ ุงููุชุนุฏุฏุฉ ูุน ุงูููุฏูู
        function createImageCarousel(images, productName, productId, youtubeUrl = null) {
            if (!images || images.length === 0) {
                return `<img src="https://placehold.co/400x160/101010/ffffff?text=${productName.replace(/\s/g, '+')}" alt="${productName}" class="w-full h-32 object-cover rounded-t-lg">`;
            }
            
            if (images.length === 1 && !youtubeUrl) {
                return `<img src="${images[0]}" alt="${productName}" class="w-full h-32 object-cover rounded-t-lg" onerror="this.onerror=null;this.src='https://placehold.co/400x160/101010/ffffff?text=${productName.replace(/\s/g, '+')}'">`;
            }
            
            let carouselHtml = `<div class="image-carousel w-full h-32 relative">`;
            
            // ุฅุถุงูุฉ ุงูุตูุฑ
            images.forEach((img, index) => {
                carouselHtml += `<img src="${img}" alt="${productName}" class="w-full h-32 object-cover rounded-t-lg absolute inset-0 transition-opacity duration-300 ${index === 0 ? 'opacity-100' : 'opacity-0'}" data-carousel-item="${productId}-${index}" onerror="this.onerror=null;this.src='https://placehold.co/400x160/101010/ffffff?text=${productName.replace(/\s/g, '+')}'"/>`;
            });
            
            // ุฅุถุงูุฉ ุงูููุฏูู ุฅุฐุง ูุงู ููุฌูุฏุงู
            if (youtubeUrl) {
                const videoId = extractYoutubeId(youtubeUrl);
                if (videoId) {
                    carouselHtml += `<iframe data-carousel-item="${productId}-video" class="w-full h-32 rounded-t-lg absolute inset-0 opacity-0 transition-opacity duration-300" src="https://www.youtube.com/embed/${videoId}?autoplay=0&mute=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                }
            }
            
            // ุฅุถุงูุฉ ุฃุณูู ุงูุชููู
            carouselHtml += `
                <button class="carousel-nav carousel-prev" onclick="changeImage('${productId}', -1, ${youtubeUrl ? 'true' : 'false'})">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                </button>
                <button class="carousel-nav carousel-next" onclick="changeImage('${productId}', 1, ${youtubeUrl ? 'true' : 'false'})">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
            `;
            
            // ุฅุถุงูุฉ ูุคุดุฑุงุช ุงูุตูุฑ ูุงูููุฏูู
            const totalItems = images.length + (youtubeUrl ? 1 : 0);
            if (totalItems > 1) {
                carouselHtml += `<div class="image-indicators">`;
                images.forEach((_, index) => {
                    carouselHtml += `<div class="indicator ${index === 0 ? 'active' : ''}" onclick="goToImage('${productId}', ${index}, ${youtubeUrl ? 'true' : 'false'})"></div>`;
                });
                if (youtubeUrl) {
                    carouselHtml += `<div class="indicator" onclick="goToImage('${productId}', ${images.length}, true)"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"></path></svg></div>`;
                }
                carouselHtml += `</div>`;
            }
            
            carouselHtml += `</div>`;
            return carouselHtml;
        }
        
        // ุฏุงูุฉ ูุงุณุชุฎุฑุงุฌ ูุนุฑู ุงูููุฏูู ูู ุฑุงุจุท ููุชููุจ
        function extractYoutubeId(url) {
            if (!url) return null;
            const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[7].length === 11) ? match[7] : null;
        }
        
        // ุฏุงูุฉ ุชุบููุฑ ุงูุตูุฑุฉ ูุน ุฏุนู ุงูููุฏูู
        function changeImage(productId, direction, hasVideo = false) {
            const carousel = document.querySelector(`[data-carousel-item^="${productId}-"]`).parentElement;
            const items = carousel.querySelectorAll('[data-carousel-item]');
            const indicators = carousel.querySelectorAll('.indicator');
            
            let currentIndex = 0;
            items.forEach((item, index) => {
                if (!item.classList.contains('opacity-0')) {
                    currentIndex = index;
                    // ุฅููุงู ุงูููุฏูู ุฅุฐุง ูุงู ููุฏ ุงูุชุดุบูู
                    if (item.tagName === 'IFRAME') {
                        item.src = item.src;
                    }
                }
            });
            
            let newIndex = currentIndex + direction;
            if (newIndex >= items.length) newIndex = 0;
            if (newIndex < 0) newIndex = items.length - 1;
            
            items[currentIndex].classList.add('opacity-0');
            indicators[currentIndex]?.classList.remove('active');
            
            items[newIndex].classList.remove('opacity-0');
            indicators[newIndex]?.classList.add('active');
            
            // ุชุดุบูู ุงูููุฏูู ุชููุงุฆูุงู
            if (items[newIndex].tagName === 'IFRAME') {
                const src = items[newIndex].src;
                items[newIndex].src = src.replace('autoplay=0', 'autoplay=1');
            }
        }
        
        // ุฏุงูุฉ ุงูุงูุชูุงู ูุตูุฑุฉ ูุญุฏุฏุฉ
        function goToImage(productId, targetIndex, hasVideo = false) {
            const carousel = document.querySelector(`[data-carousel-item^="${productId}-"]`).parentElement;
            const items = carousel.querySelectorAll('[data-carousel-item]');
            const indicators = carousel.querySelectorAll('.indicator');
            
            items.forEach((item, index) => {
                if (index === targetIndex) {
                    item.classList.remove('opacity-0');
                    indicators[index]?.classList.add('active');
                    // ุชุดุบูู ุงูููุฏูู ุชููุงุฆูุงู
                    if (item.tagName === 'IFRAME') {
                        const src = item.src;
                        item.src = src.replace('autoplay=0', 'autoplay=1');
                    }
                } else {
                    item.classList.add('opacity-0');
                    indicators[index]?.classList.remove('active');
                    // ุฅููุงู ุงูููุฏูู
                    if (item.tagName === 'IFRAME') {
                        item.src = item.src;
                    }
                }
            });
        }

        // ูุธููุฉ ุนุงูุฉ ูุนุฑุถ ุจุทุงูุงุช ุงูููุชุฌุงุช
        function displayItems(filteredData, pageKey) {
            const grid = document.getElementById('products-grid');
            const noResults = document.getElementById('no-results-message');
            
            console.log('ุนุฑุถ ุงูููุชุฌุงุช:', pageKey, 'ุนุฏุฏ ุงูููุชุฌุงุช:', filteredData?.length || 0);
            
            if (!grid) {
                console.error('ูู ูุชู ุงูุนุซูุฑ ุนูู ุนูุตุฑ products-grid');
                return;
            }

            grid.innerHTML = '';

            if (!filteredData || filteredData.length === 0) {
                if (noResults) noResults.classList.remove('hidden');
                console.log('ูุง ุชูุฌุฏ ููุชุฌุงุช ูุนุฑุถูุง ูู:', pageKey);
                return;
            }

            if (noResults) noResults.classList.add('hidden');

            filteredData.forEach(vehicle => {
                // ุจูุงุก ุชูุงุตูู ุงูููุชุฌ ุจูุงุกู ุนูู ููุน ุงูุตูุญุฉ
                let details = '';
                if (pageKey === 'vehicles') {
                    details = `ุงููุฆุฉ: <span class="font-semibold text-white">${vehicle.category}</span>`;
                } else if (pageKey === 'investments') {
                    details = `ุงููุฆุฉ: <span class="font-semibold text-white">${vehicle.category}</span>`;
                    if (vehicle.region) {
                        details += ` | ุงูููุทูุฉ: <span class="font-semibold text-white">${vehicle.region}</span>`;
                    }
                    if (vehicle.square) {
                        details += ` | ุงููุฑุจุน: <span class="font-semibold text-white">${vehicle.square}</span>`;
                    }
                } else if (pageKey === 'sponsors') {
                    details = ``;
                } else if (pageKey === 'banJail') {
                    details = ``;
                }

                // ุนุฑุถ ุงูุชูููู
                let ratingHtml = '';
                const ratingCount = vehicle.ratingCount || 0;
                if (ratingCount > 0) {
                    const averageRating = (vehicle.totalRating || 0) / ratingCount;
                    ratingHtml = `<div class="flex items-center gap-1">
                                    ${renderStars(averageRating)}
                                    <span class="text-xs text-gray-500">(${ratingCount})</span>
                                  </div>`;
                }
                // ุงูุชุญูู ูู ุงููููุฉ ูุญุงูุฉ ุงูููุชุฌ ูุชุญุฏูุฏ ุญุงูุฉ ุงูุฒุฑ ูุงููุต
                let stockInfo;
                let actionButton;
                const productStatus = vehicle.status || 'ูุชููุฑ';
                const rentalCountdown = renderRentalCountdown(vehicle);

                if (productStatus === 'ูุจุงุน') {
                    stockInfo = `<p class="text-xs text-red-500 font-bold">๐ด ูุจุงุน</p>`;
                    actionButton = `
                        <button disabled class="bg-red-600 text-white font-bold py-2 px-4 rounded-lg cursor-not-allowed opacity-75">
                            ูุจุงุน
                        </button>`;
                } else if (productStatus === 'ูุคุฌุฑ') {
                    stockInfo = `<p class="text-xs text-orange-500 font-bold">๐ผ ูุคุฌุฑ</p>`;
                    actionButton = `
                        <button disabled class="bg-orange-600 text-white font-bold py-2 px-4 rounded-lg cursor-not-allowed opacity-75">
                            ูุคุฌุฑ
                        </button>`;
                } else if (productStatus === 'ุบูุฑ ูุชููุฑ') {
                    stockInfo = `<p class="text-xs text-gray-500 font-bold">โซ ุบูุฑ ูุชููุฑ</p>`;
                    actionButton = `
                        <button disabled class="bg-gray-600 text-gray-400 font-bold py-2 px-4 rounded-lg cursor-not-allowed">
                            ุบูุฑ ูุชููุฑ
                        </button>`;
                } else if (vehicle.stock > 0) {
                    stockInfo = `<p class="text-xs text-green-500 font-bold">โ ูุชููุฑ (${vehicle.stock} ูุทุนุฉ)</p>`;
                    actionButton = `
                        <button onclick="addToCart(${vehicle.id}, '${pageKey}')" class="bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-2 px-4 rounded-lg transition duration-150 transform hover:scale-105">
                            ุฃุถู ููุณูุฉ
                        </button>`;
                } else {
                    stockInfo = `<p class="text-xs text-red-500 font-bold">ุบูุฑ ูุชููุฑ</p>`;
                    actionButton = `
                        <button disabled class="bg-gray-600 text-gray-400 font-bold py-2 px-4 rounded-lg cursor-not-allowed">
                            ุบูุฑ ูุชููุฑ ุงูุขู
                        </button>`;
                }

                // ุชุญุฏูุฏ ุงูุตูุฑ ุงููุชุงุญุฉ
                const images = vehicle.image_urls || vehicle.image_url || vehicle.imageUrls || (vehicle.image_url || vehicle.imageUrl ? [vehicle.image_url || vehicle.imageUrl] : []);
                const imageCarousel = createImageCarousel(images, vehicle.name, vehicle.id, vehicle.youtube_url || vehicle.youtubeUrl);

                grid.innerHTML += `
                    <div class="product-card">
                        ${imageCarousel}
                        <div class="p-4">
                            <h4 class="text-xl font-bold text-cyan-400 mb-1">${vehicle.name}</h4>
                            <div class="flex justify-between items-center text-sm mb-3">
                                <p class="text-gray-500">${details}</p>
                                ${ratingHtml}
                            </div>
                            ${rentalCountdown ? `<div class="mb-3">${rentalCountdown}</div>` : ''}
                            <div class="flex justify-between items-center mt-4 border-t border-gray-800 pt-3">
                                <div>
                                    <p class="text-2xl font-extrabold">${formatPrice({price: vehicle.price, currency: vehicle.currency})}</p>
                                    ${stockInfo}
                                </div>
                                <div class="flex flex-col gap-2">
                                    <button onclick="showQuickPreview(${vehicle.id}, '${pageKey}')" class="bg-purple-600 hover:bg-purple-500 text-white font-bold py-1 px-3 rounded text-sm transition">ูุนุงููุฉ ุณุฑูุนุฉ</button>
                                    ${actionButton}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        // ูุธููุฉ ุนุงูุฉ ูุชุทุจูู ุงูููุงุชุฑ
        function filterItems(pageKey, category = null) {
            const data = allProducts[pageKey];
            if (!data) return;

            // ุงูุชุนุงูู ูุน ููุงุชุฑ ุงููุฆุฉ ุงูุฌุฏูุฏุฉ ูููุฑูุจุงุช
            if ((pageKey === 'vehicles' || pageKey === 'investments') && category) {
                if (pageKey === 'vehicles') {
                    appState.filters.vehicleCategory = category;
                } else {
                    appState.filters.investmentCategory = category;
                }
                // ุชุญุฏูุซ ุดูู ุงูุฃุฒุฑุงุฑ
                document.querySelectorAll('.category-filter-btn').forEach(btn => {
                    btn.classList.remove('active', 'bg-cyan-500', 'text-gray-900');
                    btn.classList.add('bg-gray-800', 'hover:bg-gray-700', 'text-white');
                });
                // ุงูุชุฃูุฏ ูู ุฃู ุงูุฒุฑ ููุฌูุฏ ูุจู ุชุนุฏูู ุฎุตุงุฆุตู
                const activeButton = document.querySelector(`.category-filter-btn[onclick*="'${pageKey}', '${category}'"]`);
                if (activeButton) {
                    activeButton.classList.add('active', 'bg-cyan-500', 'text-gray-900');
                    activeButton.classList.remove('bg-gray-800', 'hover:bg-gray-700', 'text-white');
                }
            }

            // ูุฑุงุกุฉ ููู ุงูููุงุชุฑ ูู ุงูุตูุญุฉ
            const searchQuery = document.getElementById(`search-${pageKey}`)?.value.toLowerCase() || '';
            const typeFilter = document.getElementById('filter-type')?.value || 'all';
            const levelFilter = document.getElementById('filter-level')?.value || 'all'; // ููุฑุนุงุฉ
            let minPriceFilter = parseFloat(document.getElementById('filter-price-min')?.value) || 0; 
            let maxPriceFilter = parseFloat(document.getElementById('filter-price-max')?.value) || Infinity;

            if (appState.currentCurrency !== 'USD') {
                minPriceFilter = minPriceFilter / appState.conversionRates[appState.currentCurrency];
                maxPriceFilter = maxPriceFilter / appState.conversionRates[appState.currentCurrency];
            }
            
            let filtered = data.filter(vehicle => {
                const meetsSearch = !searchQuery || vehicle.name.toLowerCase().includes(searchQuery);
                const meetsType = true;
                const meetsVehicleCategory = (pageKey !== 'vehicles' || appState.filters.vehicleCategory === 'all' || vehicle.category === appState.filters.vehicleCategory);
                const meetsInvestmentCategory = (pageKey !== 'investments' || appState.filters.investmentCategory === 'all' || vehicle.category === appState.filters.investmentCategory);
                const meetsInvestmentRegion = (pageKey !== 'investments' || appState.filters.investmentRegion === 'all' || vehicle.region === appState.filters.investmentRegion);
                const meetsLevel = true;
                
                let priceInUsd = vehicle.price / appState.conversionRates[vehicle.currency];
                const meetsMinPrice = priceInUsd >= minPriceFilter;
                const meetsMaxPrice = priceInUsd <= maxPriceFilter;
                
                return meetsSearch && meetsType && meetsVehicleCategory && meetsInvestmentCategory && meetsInvestmentRegion && meetsLevel && meetsMinPrice && meetsMaxPrice;
            });

            displayItems(filtered, pageKey);
        }

        // ุฏุงูุฉ ููุชุฑุฉ ุญุณุจ ุงูููุทูุฉ
        function filterByRegion(region) {
            appState.filters.investmentRegion = region;
            
            // ุชุญุฏูุซ ุดูู ุงูุฃุฒุฑุงุฑ
            document.querySelectorAll('.region-filter-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-purple-500');
                btn.classList.add('bg-gray-700', 'hover:bg-gray-600');
            });
            
            const activeButton = document.querySelector(`.region-filter-btn[onclick*="'${region}'"]`);
            if (activeButton) {
                activeButton.classList.add('active', 'bg-purple-500');
                activeButton.classList.remove('bg-gray-700', 'hover:bg-gray-600');
            }
            
            filterItems('investments');
        }
        
        // ูุธููุฉ ุนุงูุฉ ููุณุญ ุงูููุงุชุฑ
        function clearFilters(pageKey) {
            document.querySelectorAll('aside select').forEach(select => select.value = 'all');
            
            document.getElementById('filter-price-min').value = '';
            document.getElementById('filter-price-max').value = '';

            if (pageKey === 'vehicles') {
                // ุฅุนุงุฏุฉ ุชุนููู ููุชุฑ ุงููุฆุฉ ุฅูู "ุงููู"
                filterItems('vehicles', 'all');
            } else if (pageKey === 'investments') {
                // ุฅุนุงุฏุฉ ุชุนููู ููุชุฑ ุงููุฆุฉ ูุงูููุทูุฉ ุฅูู "ุงููู"
                appState.filters.investmentRegion = 'all';
                filterByRegion('all');
                filterItems('investments', 'all');
            }
            filterItems(pageKey);
        }
        
        // ูุธููุฉ ุนุงูุฉ ูุฅุนุฏุงุฏ ุงูุตูุญุฉ ูุนุฑุถ ูู ุงูููุชุฌุงุช
        function setupPage(pageKey) {
            console.log('ุฅุนุฏุงุฏ ุตูุญุฉ:', pageKey, 'ุงูุจูุงูุงุช:', allProducts[pageKey]);
            const data = allProducts[pageKey] || [];
            
            displayItems(data, pageKey);
            
            if (pageKey === 'vehicles') {
                filterItems('vehicles', 'all');
            } else if (pageKey === 'investments') {
                filterItems('investments', 'all');
            }
        }

        // === ูุธุงุฆู ุงูุชุญูู ูู ุณูุฉ ุงูุชุณูู (Cart Logic) ===

        function toggleCartModal() {
            const modal = document.getElementById('cart-modal');
            modal.classList.toggle('hidden');
            if (!modal.classList.contains('hidden')) {
                renderCart(); // ุนุฑุถ ูุญุชููุงุช ุงูุณูุฉ ุนูุฏ ูุชุญูุง
            }
        }

        function addToCart(productId, pageKey) {
            let vehicle = null; // ุชู ุชุบููุฑ ุงูุงุณู ููุชูุงูู ูุน ุงูููุฏ ุงููุฏูู
            // ุงูุชุฃูุฏ ูู ุฃู allProducts[pageKey] ููุฌูุฏ ููู ูุตูููุฉ
            if (allProducts && Array.isArray(allProducts[pageKey])) {
                const found = allProducts[pageKey].find(p => p.id === productId);
                if (found) {
                    // ุงูุชุญูู ูู ุญุงูุฉ ุงูููุชุฌ ูุจู ุงูุฅุถุงูุฉ
                    const productStatus = found.status || 'ูุชููุฑ';
                    if (productStatus === 'ูุจุงุน' || productStatus === 'ุบูุฑ ูุชููุฑ' || found.stock <= 0) {
                        alert('ูุฐุง ุงูููุชุฌ ุบูุฑ ูุชุงุญ ุญุงููุงู');
                        return;
                    }
                    // ุฅุถุงูุฉ ููุชุงุญ ุงููุณู ููููุชุฌ ุนูุฏ ุฅุถุงูุชู ููุณูุฉ
                    vehicle = {...found, pageKey: pageKey};
                }
            }

            if (vehicle) {
                appState.cart.push(vehicle);
                updateCartCounter();
                console.log('ุชูุช ุฅุถุงูุฉ:', vehicle.name, 'ุฅูู ุงูุณูุฉ. ุงูุณูุฉ ุงูุขู:', appState.cart);
            }
        }

        function removeFromCart(vehicleId) {
            const indexToRemove = appState.cart.findIndex(item => item.id === vehicleId);
            if (indexToRemove > -1) {
                appState.cart.splice(indexToRemove, 1);
                renderCart(); // ุฅุนุงุฏุฉ ุนุฑุถ ุงูุณูุฉ ุจุนุฏ ุงูุญุฐู
                updateCartCounter();
            }
        }

        function renderCart() {
            validateAndResetDiscount(); // ุงูุชุญูู ูู ุตูุงุญูุฉ ุงูุฎุตู ูุจู ุนุฑุถ ุงูุณูุฉ
            const container = document.getElementById('cart-items-container');
            const totalEl = document.getElementById('cart-total');
            const checkoutSummaryContainer = document.getElementById('checkout-summary-container');
            
            if (appState.cart.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-center py-10">ุณูุฉ ุงูุชุณูู ูุงุฑุบุฉ ุญุงููุงู.</p>';
                totalEl.textContent = formatPrice({price: 0, currency: 'USD'});
                if (checkoutSummaryContainer) checkoutSummaryContainer.innerHTML = '<p class="text-gray-400 text-center">ูุง ุชูุฌุฏ ููุชุฌุงุช ูุนุฑุถ ููุฎุตูุง.</p>';
                return;
            }

            container.innerHTML = '';
            let subtotal = 0;

            appState.cart.forEach(item => {
                let itemPrice = item.price / appState.conversionRates[item.currency];
                subtotal += itemPrice;

                container.innerHTML += `
                    <div class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg mb-3">
                        <div class="flex items-center gap-4">
                            <img src="${(item.image_urls || item.imageUrls)?.[0] || item.image_url || item.imageUrl}" alt="${item.name}" class="w-16 h-16 object-cover rounded-md">
                            <div>
                                <h5 class="font-bold text-white">${item.name}</h5>
                                <div class="text-sm text-gray-400 flex gap-2 items-center">${formatPrice(item)}</div>
                            </div>
                        </div>
                        <button onclick="removeFromCart(${item.id})" class="text-red-500 hover:text-red-400 p-2 rounded-full bg-gray-900 hover:bg-gray-700 transition">
                           <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd"></path></svg>
                        </button>
                    </div>
                `;
            });

            // === ุจูุงุก ููุฎุต ุงูุทูุจ ูุตูุญุฉ ุงูุฏูุน ===
            let summaryHtml = `<div class="flex justify-between text-gray-300"><span>ุงููุฌููุน ุงููุฑุนู:</span><span>${formatSimplePrice(subtotal, 'USD')}</span></div>`;


            let total = subtotal;
            if (appState.sale.isActive && appState.sale.percentage > 0) {
                const discountAmount = subtotal * (appState.sale.percentage / 100);
                total = subtotal - discountAmount;

                // ุฅุถุงูุฉ ูุนูููุงุช ุงูุฎุตู ุฅูู ุงูุณูุฉ
                container.innerHTML += `
                    <div class="mt-4 pt-4 border-t border-gray-700 text-sm">
                        <div class="flex justify-between text-gray-300"><span>ุงููุฌููุน ุงููุฑุนู:</span><span>${formatSimplePrice(subtotal, 'USD')}</span></div>
                        <div class="flex justify-between text-yellow-400 font-bold"><span>ุฎุตู ุงูุนุฑุถ (${appState.sale.percentage}%):</span><span>-${formatSimplePrice(discountAmount, 'USD')}</span></div>
                    </div>
                `;
                // ุฅุถุงูุฉ ูููุฎุต ุงูุฏูุน
                summaryHtml += `<div class="flex justify-between text-yellow-400"><span>ุฎุตู ุงูุนุฑุถ (${appState.sale.percentage}%):</span><span>-${formatSimplePrice(discountAmount, 'USD')}</span></div>`;
            }

            // ุชุทุจูู ููุฏ ุงูุฎุตู
            if (appState.appliedDiscount.code) {
                let eligibleSubtotal = 0; 
                let discountedItemsNames = [];
                const discountTarget = appState.appliedDiscount.target;

                if (discountTarget.type === 'all') {
                    eligibleSubtotal = subtotal;
                } else if (discountTarget.type === 'section') {
                    // ุญุณุงุจ ุงููุฌููุน ุงููุฑุนู ููููุชุฌุงุช ุงููุคููุฉ ููุท
                    console.log('๐ ูุญุต ุฎุตู ุงููุณู:', discountTarget.value);
                    appState.cart.forEach(item => {
                        console.log('๐ฆ ููุชุฌ ูู ุงูุณูุฉ:', item.name, 'pageKey:', item.pageKey);
                        if (item.pageKey === discountTarget.value) { // ุงูุชุฃูุฏ ูู ุฃู ุงูููุชุฌ ููุชูู ูููุณู ุงููุณุชูุฏู
                            let itemPrice = item.price / appState.conversionRates[item.currency];
                            eligibleSubtotal += itemPrice;
                            discountedItemsNames.push(item.name);
                            console.log('โ ุชุทุจูู ุงูุฎุตู ุนูู:', item.name);
                        }
                    });
                    console.log('๐ฐ ุงููุฌููุน ุงููุคูู:', eligibleSubtotal);
                } else if (discountTarget.type === 'product') {
                     // ุญุณุงุจ ุงููุฌููุน ุงููุฑุนู ููููุชุฌุงุช ุงููุคููุฉ ููุท
                    appState.cart.forEach(item => {
                        if (item.id === discountTarget.value) { // ุงูุชุฃูุฏ ูู ุฃู ุงูููุชุฌ ูู ุงูููุชุฌ ุงููุณุชูุฏู
                            let itemPrice = item.price / appState.conversionRates[item.currency];
                            eligibleSubtotal += itemPrice;
                            discountedItemsNames.push(item.name);
                        }
                    });
                }

                const codeDiscountAmount = eligibleSubtotal * (appState.appliedDiscount.percentage / 100);
                if (eligibleSubtotal > 0) {
                    total -= codeDiscountAmount; // ุฎุตู ุฅุถุงูู ูู ุงูุฅุฌูุงูู ููุท ุฅุฐุง ูุงูุช ููุงู ููุชุฌุงุช ูุคููุฉ
                }

                container.innerHTML += `
                    <div class="mt-2 pt-2 border-t border-gray-700 text-sm">
                        <div class="flex justify-between text-green-400 font-bold"><span>ุฎุตู ุงูููุฏ (${appState.appliedDiscount.code}):</span><span>-${formatSimplePrice(codeDiscountAmount, 'USD')}</span></div>
                    </div>
                `;

                // ุฅุถุงูุฉ ูููุฎุต ุงูุฏูุน ูุน ุชูุงุตูู ุงูููุชุฌุงุช
                summaryHtml += `<div class="flex justify-between text-green-400"><span>ุฎุตู ุงูููุฏ (${appState.appliedDiscount.code}):</span><span>-${formatSimplePrice(codeDiscountAmount, 'USD')}</span></div>`;
                if (discountedItemsNames.length > 0) {
                    summaryHtml += `<div class="text-xs text-gray-400 pr-4">โ ุชุทุจู ุนูู: ${discountedItemsNames.join(', ')}</div>`;
                } else if (discountTarget.type === 'all') {
                     summaryHtml += `<div class="text-xs text-gray-400 pr-4">โ ุชุทุจู ุนูู ูู ุงูููุชุฌุงุช</div>`;
                }
            }


            let finalTotal = total * appState.conversionRates[appState.currentCurrency];
            let displayCurrency = appState.currentCurrency;

            const symbols = {
                'USD': '$', 'SAR': 'ุฑูุงู', 'AED': 'ุฏ.ุฅ',
                'KWD': 'ุฏ.ู', 'BHD': 'ุฏ.ุจ', 'OMR': 'ุฑ.ุน',
                'QAR': 'ุฑ.ู', 'IQD': 'ุฏ.ุน', 'JOD': 'ุฏ.ุฃ'
            };
            const formatted = finalTotal.toLocaleString('ar-SA', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            totalEl.textContent = displayCurrency === 'USD' ? `${formatted}$` : `${formatted} ${symbols[displayCurrency]}`;

            const finalTotalText = displayCurrency === 'USD' ? `${formatted}$` : `${formatted} ${symbols[displayCurrency]}`;

            summaryHtml += `<div class="flex justify-between text-white font-bold text-lg border-t border-gray-700 mt-2 pt-2"><span>ุงูุฅุฌูุงูู ุงูููุงุฆู:</span><span>${finalTotalText}</span></div>`;

            // ุญูู ููุฏ ุงูููุฎุต ูู ุตูุญุฉ ุงูุฏูุน
            if (checkoutSummaryContainer) checkoutSummaryContainer.innerHTML = summaryHtml;
        }

        // ุฏุงูุฉ ููุชุญูู ูู ุตูุงุญูุฉ ููุฏ ุงูุฎุตู ุงููุทุจู ูุฅุนุงุฏุฉ ุชุนูููู ุฅุฐุง ูุฒู ุงูุฃูุฑ
        function validateAndResetDiscount() {
            if (!appState.appliedDiscount.code) {
                return; // ูุง ููุฌุฏ ุฎุตู ูุทุจู
            }

            const target = appState.appliedDiscount.target;
            let isTargetStillInCart = false;

            if (target.type === 'all') {
                isTargetStillInCart = appState.cart.length > 0;
            } else if (target.type === 'section') {
                isTargetStillInCart = appState.cart.some(item => item.pageKey === target.value);
            } else if (target.type === 'product') {
                isTargetStillInCart = appState.cart.some(item => item.id === target.value);
            }

            // ุฅุฐุง ูู ูุนุฏ ุงูููุชุฌ ุฃู ุงููุณู ุงููุณุชูุฏู ููุฌูุฏูุง ูู ุงูุณูุฉุ ูู ุจุฅูุบุงุก ุงูุฎุตู
            if (!isTargetStillInCart) {
                appState.appliedDiscount = { code: null, percentage: 0, target: { type: 'all', value: null } };
                
                // ุชุญุฏูุซ ุงูุฑุณุงูุฉ ูู ุตูุญุฉ ุงูุฏูุน ุฅุฐุง ูุงูุช ููุชูุญุฉ
                const messageEl = document.getElementById('discount-message');
                const codeInput = document.getElementById('discount-code-input');
                if (messageEl) {
                    messageEl.textContent = 'ุชู ุฅูุบุงุก ุงูุฎุตู ูุนุฏู ูุฌูุฏ ููุชุฌุงุช ูุคููุฉ ูู ุงูุณูุฉ.';
                    messageEl.className = 'text-sm text-center text-yellow-400';
                    if(codeInput) codeInput.value = '';
                }
            }
        }

        function updateCartCounter() {
            const counter = document.getElementById('cart-counter');
            const count = appState.cart.length;
            counter.textContent = count;
            if (count > 0) {
                counter.classList.remove('hidden');
            } else {
                counter.classList.add('hidden');
            }
        }

        // === ูุธุงุฆู ุฅุชูุงู ุงูุทูุจ (Checkout Logic) ===

        function showCheckoutStep() {
            if (appState.cart.length === 0) {
                alert("ุณูุฉ ุงูุชุณูู ูุงุฑุบุฉ!");
                return;
            }
            document.querySelector('#cart-modal > div:not(#checkout-step)').classList.add('hidden');
            document.getElementById('checkout-step').classList.remove('hidden');
            document.getElementById('checkout-step').classList.add('flex');
        }

        function showCartStep() {
            document.querySelector('#cart-modal > div:not(#checkout-step)').classList.remove('hidden');
            document.getElementById('checkout-step').classList.add('hidden');
            document.getElementById('checkout-step').classList.remove('flex');
        }

        function generateVerificationCode() {
            const chars = 'ABCDEFGHIJKLMNPQRSTUVWXYZ123456789';
            let result = 'PX-';
            for (let i = 0; i < 6; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        async function confirmOrder() {
            const ingameName = document.getElementById('ingame-name').value;
            const customerEmail = document.getElementById('customer-email').value;
            const customerPhone = document.getElementById('customer-phone').value;
            const transactionId = document.getElementById('transaction-id').value;

            if (!ingameName.trim() || !customerEmail.trim() || !customerPhone.trim() || !transactionId.trim()) {
                alert("ุงูุฑุฌุงุก ููุก ุฌููุน ุงูุญููู ุงูุฅูุฒุงููุฉ!");
                return;
            }
            
            let subtotal = 0;
            appState.cart.forEach(item => {
                let itemPrice = item.price;
                if (item.currency === 'SAR') {
                    itemPrice = item.price / appState.conversionRate;
                }
                subtotal += itemPrice;
            });

            let totalInUSD = subtotal;
            if (appState.sale.isActive && appState.sale.percentage > 0) {
                totalInUSD -= subtotal * (appState.sale.percentage / 100);
            }
            if (appState.appliedDiscount.code) {
                let eligibleSubtotal = 0;
                const discountTarget = appState.appliedDiscount.target;
                if (discountTarget.type === 'all') {
                    eligibleSubtotal = subtotal;
                } else {
                     appState.cart.forEach(item => {
                        if ((discountTarget.type === 'section' && item.pageKey === discountTarget.value) || (discountTarget.type === 'product' && item.id === discountTarget.value)) {
                           eligibleSubtotal += item.price / appState.conversionRates[item.currency];
                        }
                    });
                }
                if (eligibleSubtotal > 0) {
                    totalInUSD -= eligibleSubtotal * (appState.appliedDiscount.percentage / 100);
                }
            }

            const newVerificationCode = generateVerificationCode();
            const newOrderId = `PX-${Date.now()}`;

            // ุญูุธ ุฑูู ุงูุฌูุงู ูู ุงูุญุณุงุจ ุฅุฐุง ูุงู ูุณุฌูุงู
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            const userPhone = currentUser ? currentUser.phone : customerPhone;
            
            const orderData = {
                id: newOrderId,
                verification_code: newVerificationCode,
                customer_name: ingameName,
                customer_email: customerEmail,
                customer_phone: userPhone,
                transaction_id: transactionId,
                total: document.getElementById('cart-total').textContent,
                total_usd: totalInUSD,
                items: appState.cart.map(item => ({ 
                    id: item.id, 
                    name: item.name, 
                    price: item.price, 
                    currency: item.currency
                })),
                discount: appState.appliedDiscount.code ? { code: appState.appliedDiscount.code } : null,
                status: 'ุจุงูุชุธุงุฑ ุงูุชุฃููุฏ',
                created_at: new Date().toISOString()
            };

            try {
                // ุญูุธ ุงูุทูุจ ูู Supabase
                await supabaseAPI.saveOrder(orderData);
                allProducts.orders.push(orderData);

                const receiptData = {
                    id: newOrderId,
                    verification_code: newVerificationCode,
                    customer_name: ingameName,
                    customer_email: customerEmail,
                    customer_phone: customerPhone,
                    transaction_id: transactionId,
                    items: appState.cart,
                    total: document.getElementById('cart-total').textContent,
                    created_at: new Date().toISOString()
                };
                
                showReceipt(receiptData);
                
                // ุฅุฑุณุงู ุงูุฅูุตุงู ุชููุงุฆูุงู ููุจุฑูุฏ
                sendReceiptEmailAuto(receiptData);
                appState.cart = [];
                updateCartCounter();
                appState.appliedDiscount = { code: null, percentage: 0, target: { type: 'all', value: null } };

            } catch (error) {
                console.error("ูุดู ูู ุชุฃููุฏ ุงูุทูุจ:", error);
                alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุทูุจู. ุญุงูู ูุฑุฉ ุฃุฎุฑู.');
            }
        }

        function closeReceipt() {
            // ุฅุบูุงู ูุงูุฐุฉ ุงูุฅูุตุงู ูุฅุนุงุฏุฉ ุชุนููู ุญุงูุฉ ุงูุทูุจ ุงูุญุงูู (ูุฃู ุงูุนููู ูู ูุฐูุจ ููุชูููู)
            document.getElementById('receipt-modal').classList.add('hidden');
            appState.currentOrderForReview = null;
        }

        async function sendReceiptEmailAuto(order) {
            try {
                const itemsList = order.items.map(item => `- ${item.name} (${formatPrice({price: item.price, currency: item.currency})})`).join('\n');
                
                await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        access_key: '5ed6948f-fcad-478d-b629-8eb47e4cc6d1',
                        subject: `ุฅูุตุงู ุทูุจ ${order.id} - ููุงุทุนุฉ ุจูุณู`,
                        from_name: 'ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู',
                        to: order.customerEmail,
                        message: `ูุฑุญุจุงู ${order.customerName},\n\nุดูุฑุงู ูุทูุจู ูู ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู!\n\nุชูุงุตูู ุงูุทูุจ:\nุฑูู ุงูุทูุจ: ${order.id}\nููุฏ ุงูุชุญูู: ${order.verificationCode}\nุงูุชุงุฑูุฎ: ${new Date(order.createdAt).toLocaleString('ar-SA')}\nุฑูู ุงูุชุญููู: ${order.transactionId}\n\nุงูููุชุฌุงุช:\n${itemsList}\n\nุงูุฅุฌูุงูู: ${order.total}\n\nูุฑุฌู ุญูุธ ููุฏ ุงูุชุญูู ูุชูุฏููู ููุฏุนู ุงูููู.\n\nุดูุฑุงู ูุซูุชู ุจูุง!`
                    })
                });
            } catch (error) {
                console.log('ูุดู ุงูุฅุฑุณุงู ุงูุชููุงุฆู');
            }
        }

        async function sendReceiptEmail() {
            const order = appState.currentOrderForReview;
            if (!order) return;

            const button = event.target;
            button.disabled = true;
            button.textContent = 'ุฌุงุฑู ุงูุฅุฑุณุงู...';

            try {
                const itemsList = order.items.map(item => `- ${item.name} (${formatPrice({price: item.price, currency: item.currency})})`).join('\n');
                
                const response = await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        access_key: '5ed6948f-fcad-478d-b629-8eb47e4cc6d1',
                        subject: `ุฅูุตุงู ุทูุจ ${order.id} - ููุงุทุนุฉ ุจูุณู`,
                        from_name: 'ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู',
                        to: order.customerEmail,
                        message: `ูุฑุญุจุงู ${order.customerName},\n\nุดูุฑุงู ูุทูุจู ูู ูุชุฌุฑ ููุงุทุนุฉ ุจูุณู!\n\nุชูุงุตูู ุงูุทูุจ:\nุฑูู ุงูุทูุจ: ${order.id}\nููุฏ ุงูุชุญูู: ${order.verificationCode}\nุงูุชุงุฑูุฎ: ${new Date(order.createdAt).toLocaleString('ar-SA')}\nุฑูู ุงูุชุญููู: ${order.transactionId}\n\nุงูููุชุฌุงุช:\n${itemsList}\n\nุงูุฅุฌูุงูู: ${order.total}\n\nูุฑุฌู ุญูุธ ููุฏ ุงูุชุญูู ูุชูุฏููู ููุฏุนู ุงูููู.\n\nุดูุฑุงู ูุซูุชู ุจูุง!`
                    })
                });

                const result = await response.json();
                if (result.success) {
                    alert('โ ุชู ุฅุฑุณุงู ุงูุฅูุตุงู ุฅูู ุจุฑูุฏู ุงูุฅููุชุฑููู ุจูุฌุงุญ!');
                } else {
                    throw new Error('ูุดู ุงูุฅุฑุณุงู');
                }
            } catch (error) {
                alert('โ ุญุฏุซ ุฎุทุฃ ูู ุฅุฑุณุงู ุงูุจุฑูุฏ. ูุฑุฌู ุญูุธ ููุทุฉ ุดุงุดุฉ ููุฅูุตุงู.');
            } finally {
                button.disabled = false;
                button.textContent = 'ุฅุฑุณุงู ููุจุฑูุฏ';
            }
        }

        function showReceipt(order) {
            // ุฅุฎูุงุก ูุงูุฐุฉ ุงูุณูุฉ
            document.getElementById('cart-modal').classList.add('hidden');

            // ููุก ุจูุงูุงุช ุงูุฅูุตุงู
            appState.currentOrderForReview = order; // ุญูุธ ุงูุทูุจ ุงูุญุงูู ููุชูููู
            document.getElementById('receipt-order-id').textContent = order.id;
            document.getElementById('receipt-verification-code').textContent = order.verification_code || order.verificationCode; // ุนุฑุถ ููุฏ ุงูุชุญูู
            document.getElementById('receipt-customer-name').textContent = order.customer_name || order.customerName;
            document.getElementById('receipt-date').textContent = new Date(order.created_at || order.createdAt).toLocaleString('ar-SA');
            document.getElementById('receipt-transaction-id').textContent = order.transaction_id || order.transactionId;
            document.getElementById('receipt-total').textContent = order.total;
            
            const itemsList = document.getElementById('receipt-items');
            itemsList.innerHTML = order.items.map(item => `<li>${item.name}</li>`).join('');

            // ุฅุธูุงุฑ ูุงูุฐุฉ ุงูุฅูุตุงู
            document.getElementById('receipt-modal').classList.remove('hidden');
        }

        async function showReviewModal() {
            document.getElementById('receipt-modal').classList.add('hidden');
            const container = document.getElementById('review-items-container');
            container.innerHTML = ''; // ุชูุฑูุบ ุงููุญุชููุงุช ุงููุฏููุฉ

            appState.currentOrderForReview.items.forEach(item => {
                container.innerHTML += `
                    <div class="bg-gray-800 p-4 rounded-lg" data-product-id="${item.id}">
                        <p class="font-bold text-white mb-2">${item.name}</p>
                        <div class="flex justify-center items-center gap-1 star-rating" data-rating="0">
                            ${[...Array(5)].map((_, i) => `<svg onclick="setRating(this, ${i + 1})" class="w-8 h-8 text-gray-600 cursor-pointer transition-colors" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>`).join('')}
                        </div>
                    </div>
                `;
            });

            document.getElementById('review-modal').classList.remove('hidden');
            document.getElementById('review-modal').classList.add('flex');
        }

        function setRating(starElement, rating) {
            const parent = starElement.parentElement;
            parent.dataset.rating = rating;
            const stars = parent.querySelectorAll('svg');
            stars.forEach((star, index) => {
                star.classList.toggle('text-yellow-400', index < rating);
                star.classList.toggle('text-gray-600', index >= rating);
            });
        }

        async function submitRatings() {
            const ratings = [];
            document.querySelectorAll('#review-items-container .star-rating').forEach(container => {
                const rating = parseInt(container.dataset.rating);
                if (rating > 0) {
                    ratings.push({
                        id: parseInt(container.parentElement.dataset.productId),
                        rating: rating
                    });
                }
            });

            if (ratings.length === 0) {
                alert('ุงูุฑุฌุงุก ุชูููู ููุชุฌ ูุงุญุฏ ุนูู ุงูุฃูู.');
                return;
            }

            try {
                const currentRecord = await getAllData(); // ุฌูุจ ุฃุญุฏุซ ุงูุจูุงูุงุช ุฏุงุฆูุงู

                ratings.forEach(r => {
                    for (const key in currentRecord) {
                        if (Array.isArray(currentRecord[key])) {
                            const product = currentRecord[key].find(p => p.id === r.id);
                            if (product) {
                                product.totalRating = (product.totalRating || 0) + r.rating;
                                product.ratingCount = (product.ratingCount || 0) + 1;
                                break;
                            }
                        }
                    }
                });

                await saveDataToBin(currentRecord);
                allProducts = currentRecord;
                alert('ุดูุฑุงู ูู! ุชู ุฅุฑุณุงู ุชููููุงุชู.');
            } catch (error) {
                console.error("ูุดู ูู ุฅุฑุณุงู ุงูุชููููุงุช:", error);
                alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุชููููุงุชู.");
            } finally {
                finalClose();
            }
        }



        function finalClose() {
            document.getElementById('review-modal').classList.add('hidden');
            appState.currentOrderForReview = null;
        }

        // === ูุธุงุฆู ููุฏ ุงูุฎุตู ===
        async function applyDiscountCode() {
            const codeInput = document.getElementById('discount-code-input');
            const messageEl = document.getElementById('discount-message');
            const customerEmail = document.getElementById('customer-email').value;
            const customerPhone = document.getElementById('customer-phone').value;
            const code = codeInput.value.trim().toUpperCase();

            if (!customerEmail) {
                messageEl.textContent = 'ุงูุฑุฌุงุก ุฅุฏุฎุงู ุจุฑูุฏู ุงูุฅููุชุฑููู ุฃููุงู.';
                messageEl.className = 'text-sm text-center text-red-400';
                return;
            }
            if (!customerPhone) {
                messageEl.textContent = 'ุงูุฑุฌุงุก ุฅุฏุฎุงู ุฑูู ูุงุชูู ุฃููุงู.';
                messageEl.className = 'text-sm text-center text-red-400';
                return;
            }

            if (!code) {
                messageEl.textContent = 'ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุฏ ุงูุฎุตู.';
                messageEl.className = 'text-sm text-center text-red-400';
                return;
            }

            const codes = allProducts.discountCodes || [];
            const foundCode = codes.find(c => c.code === code);

            if (!foundCode) {
                messageEl.textContent = 'ุงูููุฏ ุบูุฑ ุตุญูุญ.';
                messageEl.className = 'text-sm text-center text-red-400';
            } else if (foundCode.usage_limit && foundCode.usage_limit > 0 && foundCode.used_by && foundCode.used_by.length >= foundCode.usage_limit) {
                messageEl.textContent = `ูุฐุง ุงูููุฏ ูุตู ููุญุฏ ุงูุฃูุตู (${foundCode.usage_limit} ูุฑุงุช).`;
                messageEl.className = 'text-sm text-center text-red-400';
            } else if (foundCode.usage_limit && foundCode.usage_limit > 0 && foundCode.used_by && foundCode.used_by.some(u => u.email === customerEmail || u.phone === customerPhone)) {
                messageEl.textContent = 'ููุฏ ุงุณุชุฎุฏูุช ูุฐุง ุงูููุฏ ูู ูุจู.';
                messageEl.className = 'text-sm text-center text-red-400';
            } else {
                // ุงูุชุญูู ูู ูุฌูุฏ ููุชุฌุงุช ูุคููุฉ ูู ุงูุณูุฉ ูุจู ุชุทุจูู ุงูููุฏ
                let hasEligibleProducts = false;
                const discountTarget = foundCode.target;
                
                if (discountTarget.type === 'all') {
                    hasEligibleProducts = appState.cart.length > 0;
                } else if (discountTarget.type === 'section') {
                    hasEligibleProducts = appState.cart.some(item => item.pageKey === discountTarget.value);
                } else if (discountTarget.type === 'product') {
                    hasEligibleProducts = appState.cart.some(item => item.id === discountTarget.value);
                }
                
                // ุฅุฐุง ูู ุชูุฌุฏ ููุชุฌุงุช ูุคููุฉุ ูุง ูุทุจู ุงูููุฏ ููุง ูุณุฌูู ููุณุชุฎุฏู
                if (!hasEligibleProducts) {
                    const targetName = discountTarget.type === 'section' ? 'ุงููุณู ุงููุญุฏุฏ' : (discountTarget.type === 'product' ? 'ุงูููุชุฌ ุงููุญุฏุฏ' : 'ุงูููุชุฌุงุช');
                    messageEl.textContent = `ูุฐุง ุงูููุฏ ูุง ูุทุจู ุนูู ุงูููุชุฌุงุช ูู ุณูุชู. ุงูููุฏ ุฎุงุต ุจู ${targetName} ููุท.`;
                    messageEl.className = 'text-sm text-center text-yellow-400';
                    return;
                }
                
                // ุชุณุฌูู ุงุณุชุฎุฏุงู ุงูููุฏ ููุท ุฅุฐุง ูุงู ููุงู ููุชุฌุงุช ูุคููุฉ
                if (!foundCode.used_by) {
                    foundCode.used_by = [];
                }
                foundCode.used_by.push({ email: customerEmail, phone: customerPhone, date: new Date().toISOString() });

                appState.appliedDiscount = { code: foundCode.code, percentage: foundCode.percentage, target: foundCode.target };
                
                // ุนุฑุถ ุฑุณุงูุฉ ูุน ุนุฏุฏ ุงูุงุณุชุฎุฏุงูุงุช ุงููุชุจููุฉ
                const remainingUses = foundCode.usage_limit ? foundCode.usage_limit - foundCode.used_by.length : 'โ';
                messageEl.textContent = `ุชู ุชุทุจูู ุฎุตู ${foundCode.percentage}% ุจูุฌุงุญ! (ูุชุจูู: ${remainingUses})`;
                messageEl.className = 'text-sm text-center text-green-400';

                // ุญูุธ ุงูุชุบููุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
                await supabaseAPI.updateDiscountCode(foundCode.id, { used_by: foundCode.used_by });

                renderCart(); // ุฅุนุงุฏุฉ ุนุฑุถ ุงูุณูุฉ ูุชุญุฏูุซ ุงูุฅุฌูุงูู
            }
        }

        // === ูุธุงุฆู ูุงูุฐุฉ ุงูุชุญููู ุงูุจููู ===
        function showBankTransferModal() {
            document.getElementById('bank-transfer-modal').classList.remove('hidden');
            document.getElementById('bank-transfer-modal').classList.add('flex');
        }

        function closeBankTransferModal() {
            document.getElementById('bank-transfer-modal').classList.add('hidden');
            document.getElementById('bank-transfer-modal').classList.remove('flex');
        }

        function copyToClipboard(buttonElement, elementId, message) {
            const textToCopy = document.getElementById(elementId).innerText;
            navigator.clipboard.writeText(textToCopy).then(() => {
                alert(message);
            }).catch(err => {
                console.error('ูุดู ูู ุงููุณุฎ:', err);
            });
        }

        // ูุธุงุฆู ุนุฑุถ ูุตู ุงูููุชุฌ
        function showDescription(productId, productName, description) {
            document.getElementById('description-modal-title').textContent = `ูุตู ${productName}`;
            document.getElementById('description-modal-content').textContent = description;
            document.getElementById('description-modal').classList.remove('hidden');
        }

        function closeDescriptionModal() {
            document.getElementById('description-modal').classList.add('hidden');
        }

        // ูุธุงุฆู ุงููุนุงููุฉ ุงูุณุฑูุนุฉ
        function showQuickPreview(productId, pageKey) {
            const product = allProducts[pageKey]?.find(p => p.id === productId);
            if (!product) return;

            const images = product.image_urls || product.imageUrls || (product.image_url || product.imageUrl ? [product.image_url || product.imageUrl] : []);
            const youtubeUrl = product.youtube_url || product.youtubeUrl || null;
            const videoId = youtubeUrl ? extractYoutubeId(youtubeUrl) : null;

            let stockInfo, actionButton;
            const productStatus = product.status || 'ูุชููุฑ';

            if (productStatus === 'ูุจุงุน') {
                stockInfo = `<span class="text-red-400 font-bold">๐ด ูุจุงุน</span>`;
                actionButton = `<button disabled class="bg-red-600 text-white font-bold py-3 px-8 rounded-lg cursor-not-allowed opacity-75 w-full">ูุจุงุน</button>`;
            } else if (productStatus === 'ุบูุฑ ูุชููุฑ') {
                stockInfo = `<span class="text-gray-500 font-bold">โซ ุบูุฑ ูุชููุฑ</span>`;
                actionButton = `<button disabled class="bg-gray-600 text-gray-400 font-bold py-3 px-8 rounded-lg cursor-not-allowed w-full">ุบูุฑ ูุชููุฑ</button>`;
            } else if (product.stock > 0) {
                stockInfo = `<span class="text-green-400 font-bold">โ ูุชููุฑ (${product.stock} ูุทุนุฉ)</span>`;
                actionButton = `<button onclick="addToCart(${product.id}, '${pageKey}'); closeQuickPreview();" class="bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-3 px-8 rounded-lg transition w-full">ุฃุถู ููุณูุฉ</button>`;
            } else {
                stockInfo = `<span class="text-red-400 font-bold">ุบูุฑ ูุชููุฑ ุญุงููุงู</span>`;
                actionButton = `<button disabled class="bg-gray-600 text-gray-400 font-bold py-3 px-8 rounded-lg cursor-not-allowed w-full">ุบูุฑ ูุชููุฑ ุงูุขู</button>`;
            }

            let ratingHtml = '';
            const ratingCount = product.ratingCount || 0;
            if (ratingCount > 0) {
                const averageRating = (product.totalRating || 0) / ratingCount;
                ratingHtml = `<div class="flex items-center gap-2">
                                ${renderStars(averageRating)}
                                <span class="text-sm text-gray-400">(${ratingCount} ุชูููู)</span>
                              </div>`;
            }

            const content = document.getElementById('quick-preview-content');
            content.innerHTML = `
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- ูุณู ุงูุตูุฑ -->
                    <div>
                        <div class="relative rounded-xl overflow-hidden border border-gray-800 mb-4">
                            <img id="preview-main-img" src="${images[0] || 'https://placehold.co/600x400'}" alt="${product.name}" class="w-full h-96 object-cover" />
                            ${videoId ? `<iframe id="preview-video" class="w-full h-96 absolute inset-0 opacity-0 transition-opacity duration-300" src="https://www.youtube.com/embed/${videoId}?autoplay=0&mute=1" frameborder="0" allowfullscreen></iframe>` : ''}
                        </div>
                        ${images.length > 1 || videoId ? `
                        <div class="flex gap-2 overflow-x-auto pb-2">
                            ${images.map((img, idx) => `
                                <img src="${img}" onclick="changePreviewImage('${img}', false)" class="w-20 h-20 object-cover rounded-lg border-2 border-gray-700 hover:border-cyan-500 cursor-pointer transition" />
                            `).join('')}
                            ${videoId ? `<div onclick="changePreviewImage('', true)" class="w-20 h-20 bg-red-600 rounded-lg border-2 border-gray-700 hover:border-cyan-500 cursor-pointer flex items-center justify-center transition"><svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"></path></svg></div>` : ''}
                        </div>` : ''}
                    </div>

                    <!-- ูุณู ุงููุนูููุงุช -->
                    <div class="flex flex-col gap-6">
                        <div>
                            <h3 class="text-3xl font-bold text-white mb-2">${product.name}</h3>
                            ${ratingHtml}
                        </div>

                        <div class="flex items-baseline gap-3">
                            <span class="text-4xl font-black text-cyan-400">${formatPrice({price: product.price, currency: product.currency})}</span>
                            ${stockInfo}
                        </div>

                        ${product.description ? `
                        <div class="bg-gray-800/50 p-4 rounded-lg">
                            <h4 class="text-lg font-bold text-white mb-2">ุงููุตู</h4>
                            <p class="text-gray-300 leading-relaxed">${product.description}</p>
                        </div>` : ''}

                        <div class="grid grid-cols-2 gap-4 text-sm">
                            ${product.category ? `<div class="bg-gray-800/50 p-3 rounded-lg"><span class="text-gray-400">ุงููุฆุฉ:</span> <span class="text-white font-bold">${product.category}</span></div>` : ''}
                            ${product.type ? `<div class="bg-gray-800/50 p-3 rounded-lg"><span class="text-gray-400">ุงูููุน:</span> <span class="text-white font-bold">${product.type}</span></div>` : ''}
                        </div>

                        <div class="mt-auto">
                            ${actionButton}
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('quick-preview-modal').classList.remove('hidden');
        }

        function closeQuickPreview() {
            document.getElementById('quick-preview-modal').classList.add('hidden');
        }

        function changePreviewImage(imgSrc, isVideo) {
            const img = document.getElementById('preview-main-img');
            const video = document.getElementById('preview-video');
            
            if (isVideo && video) {
                img.classList.add('opacity-0');
                video.classList.remove('opacity-0');
                video.src = video.src.replace('autoplay=0', 'autoplay=1');
            } else {
                img.src = imgSrc;
                img.classList.remove('opacity-0');
                if (video) {
                    video.classList.add('opacity-0');
                    video.src = video.src.replace('autoplay=1', 'autoplay=0');
                }
            }
        }

        // ูุธุงุฆู ุฅุถุงููุฉ ููููุงูุฐ ุงููุงููููุฉ
        function showLegalModal(title) {
            document.getElementById('legal-modal-title').textContent = title;
            document.getElementById('legal-modal').classList.remove('hidden');
        }

        function closeLegalModal() {
            document.getElementById('legal-modal').classList.add('hidden');
        }

        // ูุธุงุฆู ุงูุชุญูู ุจุงูุนููุฉ
        function toggleCurrency() {
            const currencies = ['USD', 'SAR', 'AED', 'KWD', 'BHD', 'OMR', 'QAR', 'IQD', 'JOD'];
            const currentIndex = currencies.indexOf(appState.currentCurrency);
            appState.currentCurrency = currencies[(currentIndex + 1) % currencies.length];
            updateCurrencyButton();
            renderPage();
        }
        
        function updateSaleBanner() {
            const banner = document.getElementById('sale-banner');
            if (appState.sale.isActive) {
                let bannerText = appState.sale.text || '๐ ุนุฑุถ ุฎุงุต! ุฎุตู {percentage}% ุนูู ุฌููุน ุงูููุชุฌุงุช!';
                if (appState.sale.percentage > 0) {
                    bannerText = bannerText.replace('{percentage}', appState.sale.percentage);
                } else {
                    bannerText = bannerText.replace('{percentage}%', '').replace('{percentage}', '');
                }
                banner.innerHTML = bannerText;
                banner.style.background = appState.sale.color || '#f59e0b';
                banner.style.color = '#1a202c';
                banner.classList.remove('hidden');
            } else {
                banner.classList.add('hidden');
            }
        }

        function updatePriceFilterLabel() {
            const label = document.getElementById('price-filter-label');
            if (label) {
                const currencyText = appState.currentCurrency === 'USD' ? 'ุจุงูุฏููุงุฑ' : 'ุจุงูุฑูุงู ุงูุณุนูุฏู';
                label.textContent = `ูุทุงู ุงูุณุนุฑ (${currencyText})`;
            }
        }






        function updateCurrencyButton() {
            const button = document.getElementById('currency-toggle-button');
            const currencies = {
                'USD': { name: 'USD', symbol: '$' },
                'SAR': { name: 'SAR', symbol: 'ุฑูุงู' },
                'AED': { name: 'AED', symbol: 'ุฏ.ุฅ' },
                'KWD': { name: 'KWD', symbol: 'ุฏ.ู' },
                'BHD': { name: 'BHD', symbol: 'ุฏ.ุจ' },
                'OMR': { name: 'OMR', symbol: 'ุฑ.ุน' },
                'QAR': { name: 'QAR', symbol: 'ุฑ.ู' },
                'IQD': { name: 'IQD', symbol: 'ุฏ.ุน' },
                'JOD': { name: 'JOD', symbol: 'ุฏ.ุฃ' }
            };
            const curr = currencies[appState.currentCurrency];
            button.innerHTML = `
                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg>
                <span class="text-white/80 text-sm">ุงูุนููุฉ:</span>
                <span class="text-white font-black">${curr.name}</span>
                <span class="text-white/70">${curr.symbol}</span>
            `;
        }

        function handleLogoClick(event) {
            event.preventDefault();
            logoClickCount++;
            
            if (logoClickCount === 5) {
                // ุชุนููู ุฅุฐู ุงููุตูู ููุฅุฏูู
                sessionStorage.setItem('adminAccess', 'true');
                window.location.href = 'admin.html';
                return;
            }
            
            // ุฅุนุงุฏุฉ ุชุนููู ุงูุนุฏุงุฏ ุจุนุฏ ุซุงููุชูู
            setTimeout(() => {
                logoClickCount = 0;
            }, 2000);
            
            // ุงูุงูุชูุงู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ ูู ุงูููุฑุงุช ุงูุนุงุฏูุฉ
            navigateTo('home');
        }

        function setupNavigation() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    navigateTo(page);
                });
            });

            document.getElementById('mobile-menu-button').addEventListener('click', function() {
                document.getElementById('mobile-menu').classList.toggle('hidden');
            });

            document.getElementById('cart-button').addEventListener('click', toggleCartModal);
            document.getElementById('close-cart-button').addEventListener('click', toggleCartModal);
            document.getElementById('currency-toggle-button').addEventListener('click', toggleCurrency);
            
            const helpBotBtn = document.getElementById('help-bot-button');
            if (helpBotBtn) {
                helpBotBtn.addEventListener('click', openHelpBot);
            }
        }
        
        function openHelpBot() {
            document.getElementById('help-bot-modal').classList.remove('hidden');
        }
        
        function closeHelpBot() {
            document.getElementById('help-bot-modal').classList.add('hidden');
        }

        function navigateTo(page, filter = null) {
            console.log('ุงูุงูุชูุงู ุฅูู ุตูุญุฉ:', page, 'ููุชุฑ:', filter);
            if (appState.currentPage !== page) {
                appState.currentPage = page;
                renderPage();
            }
            // ุชุทุจูู ุงูููุชุฑ ุจุนุฏ ุนุฑุถ ุงูุตูุญุฉ
            if (filter && page === 'vehicles') {
                setTimeout(() => {
                    filterItems('vehicles', filter);
                }, 100);
            }
        }
        
        function renderPage() {
            try {
                console.log('ุนุฑุถ ุตูุญุฉ:', appState.currentPage);
                const mainContent = document.getElementById('main-content');
                const videoElement = document.getElementById('heroVideo');
                if (videoElement && videoElement.pause) videoElement.pause();
                
                // ุฅููุงู ููุฏูู YouTube ุนูุฏ ูุบุงุฏุฑุฉ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
                if (appState.currentPage !== 'home' && typeof jQuery !== 'undefined') {
                    jQuery("#hero-section").YTPPause();
                }
                
                mainContent.innerHTML = '';

                switch (appState.currentPage) {
                    case 'home':
                        console.log('ุนุฑุถ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ');
                        mainContent.innerHTML = renderHomePage();
                        renderFeaturedProducts();
                        // ุชูุนูู ููุฏูู ุงูุฎูููุฉ ุนูุฏ ุงูุนูุฏุฉ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
                        setTimeout(initYouTubeBackground, 500);
                        break;
                    case 'vehicles':
                        console.log('ุนุฑุถ ุตูุญุฉ ุงููุฑูุจุงุช');
                        mainContent.innerHTML = renderVehiclesPage();
                        setupPage('vehicles');
                        updatePriceFilterLabel();
                        break;
                    case 'investment':
                        console.log('ุนุฑุถ ุตูุญุฉ ุงูุงุณุชุซูุงุฑ');
                        mainContent.innerHTML = renderInvestmentPage();
                        setupPage('investments');
                        updatePriceFilterLabel();
                        break;
                    case 'sponsors':
                        console.log('ุนุฑุถ ุตูุญุฉ ุงูุฑุนุงุฉ');
                        mainContent.innerHTML = renderSponsorsPage();
                        setupPage('sponsors');
                        updatePriceFilterLabel();
                        break;
                    case 'money-services':
                        console.log('ุนุฑุถ ุตูุญุฉ ุฎุฏูุงุช ุงูุฃููุงู');
                        mainContent.innerHTML = renderMoneyServicesPage();
                        setupPage('moneyServices');
                        updatePriceFilterLabel();
                        break;
                    case 'ban-jail':
                        console.log('ุนุฑุถ ุตูุญุฉ ุงูุจุงูุฏ ูุงูุณุฌู');
                        mainContent.innerHTML = renderBanJailPage();
                        setupPage('banJail');
                        updatePriceFilterLabel();
                        break;
                    default:
                        console.log('ุตูุญุฉ ุบูุฑ ูุนุฑููุฉุ ุนุฑุถ ุงูุฑุฆูุณูุฉ');
                        mainContent.innerHTML = renderHomePage();
                }
                window.scrollTo(0, 0);
                const mobileMenu = document.getElementById('mobile-menu');
                if (mobileMenu) mobileMenu.classList.add('hidden');
                console.log('ุชู ุนุฑุถ ุงูุตูุญุฉ ุจูุฌุงุญ');
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุนุฑุถ ุงูุตูุญุฉ:', error);
            }
        }

        // ุชููุฆุฉ ููุฏูู ุงูุฎูููุฉ
        function initYouTubeBackground() {
            if (typeof jQuery !== 'undefined' && jQuery.fn.YTPlayer) {
                jQuery("#hero-section").YTPlayer();
            }
        }

        // ุชููุฆุฉ ุงูุชุทุจูู ุนูุฏ ุชุญููู ุงููุงูุฐุฉ ูุฃูู ูุฑุฉ
        window.onload = async function() {
            try {
                console.log('ุจุฏุก ุชุญููู ุงููุชุฌุฑ...');
                
                // ุนุฑุถ ุฑุณุงูุฉ ุชุญููู
                document.getElementById('main-content').innerHTML = `
                    <div class="min-h-screen flex flex-col items-center justify-center text-center p-4">
                        <div class="animate-spin rounded-full h-32 w-32 border-b-2 border-cyan-500 mb-4"></div>
                        <h2 class="text-2xl font-bold text-white mb-2">ุฌุงุฑู ุชุญููู ุงููุชุฌุฑ...</h2>
                        <p class="text-gray-400">ูุฑุฌู ุงูุงูุชุธุงุฑ ุจูููุง ูุญูู ุฃุญุฏุซ ุงูููุชุฌุงุช</p>
                    </div>
                `;
                
                console.log('ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช ูู Supabase...');
                const isStoreActive = await loadProducts();
                
                if (isStoreActive) {
                    console.log('ุชู ุชุญููู ุงูุจูุงูุงุชุ ุชููุฆุฉ ุงููุงุฌูุฉ...');
                    setupNavigation();
                    updateSaleBanner();
                    updateCurrencyButton();
                    renderPage();
                    
                    // ุชูุนูู ููุฏูู ุงูุฎูููุฉ ุจุนุฏ ุนุฑุถ ุงูุตูุญุฉ
                    setTimeout(initYouTubeBackground, 1000);
                    
                    console.log('ุชู ุชุญููู ุงููุชุฌุฑ ุจูุฌุงุญ');
                } else {
                    console.log('ุงููุชุฌุฑ ูู ูุถุน ุงูุตูุงูุฉ');
                }
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุชููุฆุฉ ุงููุชุฌุฑ:', error);
                document.getElementById('main-content').innerHTML = `
                    <div class="min-h-screen flex flex-col items-center justify-center text-center p-4">
                        <div class="text-red-500 text-6xl mb-4">โ๏ธ</div>
                        <h2 class="text-2xl font-bold text-white mb-2">ุฎุทุฃ ูู ุชุญููู ุงููุชุฌุฑ</h2>
                        <p class="text-gray-400 mb-4">${error.message}</p>
                        <button onclick="location.reload()" class="bg-cyan-500 hover:bg-cyan-400 text-gray-900 font-bold py-2 px-4 rounded">ุฅุนุงุฏุฉ ุงููุญุงููุฉ</button>
                    </div>
                `;
            }
        };
    </script>
</body>
</html>


